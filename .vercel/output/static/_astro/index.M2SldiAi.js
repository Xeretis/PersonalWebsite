import{b as Kr,g as Jr}from"./index.PX_EsW8Y.js";function Yr(e,r){for(var t=0;t<r.length;t++){const i=r[t];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(i,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const Zr={},et=Object.freeze(Object.defineProperty({__proto__:null,default:Zr},Symbol.toStringTag,{value:"Module"})),R=Kr(et),Ve=function(e){return typeof e<"u"&&e!==null},rt=function(e){return typeof e=="object"},tt=function(e){return Object.prototype.toString.call(e)==="[object Object]"},it=function(e){return typeof e=="function"},nt=function(e){return typeof e=="boolean"},at=function(e){return e instanceof Buffer},st=function(e){if(Ve(e))switch(e.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return!0}return!1},ot=function(e){return e instanceof ArrayBuffer},lt=function(e){return typeof e=="string"&&e.length>0},ct=function(e){return typeof e=="number"&&!Number.isNaN(e)},ht=function(e){return Number.isInteger(e)},ft=function(e,r,t){return e>=r&&e<=t},dt=function(e,r){return r.includes(e)},ut=function(e,r,t){return new Error(`Expected ${r} for ${e} but received ${t} of type ${typeof t}`)};var M={defined:Ve,object:rt,plainObject:tt,fn:it,bool:nt,buffer:at,typedArray:st,arrayBuffer:ot,string:lt,number:ct,integer:ht,inRange:ft,inArray:dt,invalidParameterError:ut},ue={};const mt=typeof process=="object"&&ue&&ue.NODE_DEBUG&&/\bsemver\b/i.test(ue.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var Qe=mt;const gt="2.0.0",Ke=256,bt=Number.MAX_SAFE_INTEGER||9007199254740991,pt=16,wt=Ke-6,yt=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Je={MAX_LENGTH:Ke,MAX_SAFE_COMPONENT_LENGTH:pt,MAX_SAFE_BUILD_LENGTH:wt,MAX_SAFE_INTEGER:bt,RELEASE_TYPES:yt,SEMVER_SPEC_VERSION:gt,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},ye={exports:{}};(function(e,r){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:a}=Je,s=Qe;r=e.exports={};const c=r.re=[],f=r.safeRe=[],l=r.src=[],d=r.t={};let w=0;const v="[a-zA-Z0-9-]",q=[["\\s",1],["\\d",a],[v,i]],Vr=G=>{for(const[$,Q]of q)G=G.split(`${$}*`).join(`${$}{0,${Q}}`).split(`${$}+`).join(`${$}{1,${Q}}`);return G},g=(G,$,Q)=>{const Qr=Vr($),K=w++;s(G,K,$),d[G]=K,l[K]=$,c[K]=new RegExp($,Q?"g":void 0),f[K]=new RegExp(Qr,Q?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${v}*`),g("MAINVERSION",`(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${l[d.NUMERICIDENTIFIER]}|${l[d.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${l[d.NUMERICIDENTIFIERLOOSE]}|${l[d.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${l[d.PRERELEASEIDENTIFIER]}(?:\\.${l[d.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${l[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[d.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${v}+`),g("BUILD",`(?:\\+(${l[d.BUILDIDENTIFIER]}(?:\\.${l[d.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${l[d.MAINVERSION]}${l[d.PRERELEASE]}?${l[d.BUILD]}?`),g("FULL",`^${l[d.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${l[d.MAINVERSIONLOOSE]}${l[d.PRERELEASELOOSE]}?${l[d.BUILD]}?`),g("LOOSE",`^${l[d.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${l[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${l[d.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:${l[d.PRERELEASE]})?${l[d.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:${l[d.PRERELEASELOOSE]})?${l[d.BUILD]}?)?)?`),g("XRANGE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAINLOOSE]}$`),g("COERCE",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?(?:$|[^\\d])`),g("COERCERTL",l[d.COERCE],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${l[d.LONETILDE]}\\s+`,!0),r.tildeTrimReplace="$1~",g("TILDE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${l[d.LONECARET]}\\s+`,!0),r.caretTrimReplace="$1^",g("CARET",`^${l[d.LONECARET]}${l[d.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${l[d.LONECARET]}${l[d.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${l[d.GTLT]}\\s*(${l[d.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]}|${l[d.XRANGEPLAIN]})`,!0),r.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${l[d.XRANGEPLAIN]})\\s+-\\s+(${l[d.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${l[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[d.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(ye,ye.exports);var Ye=ye.exports;const vt=Object.freeze({loose:!0}),Et=Object.freeze({}),xt=e=>e?typeof e!="object"?vt:e:Et;var Pt=xt;const Te=/^[0-9]+$/,Ze=(e,r)=>{const t=Te.test(e),i=Te.test(r);return t&&i&&(e=+e,r=+r),e===r?0:t&&!i?-1:i&&!t?1:e<r?-1:1},It=(e,r)=>Ze(r,e);var kt={compareIdentifiers:Ze,rcompareIdentifiers:It};const te=Qe,{MAX_LENGTH:Ce,MAX_SAFE_INTEGER:ie}=Je,{safeRe:Oe,t:Be}=Ye,Rt=Pt,{compareIdentifiers:U}=kt;let At=class A{constructor(r,t){if(t=Rt(t),r instanceof A){if(r.loose===!!t.loose&&r.includePrerelease===!!t.includePrerelease)return r;r=r.version}else if(typeof r!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof r}".`);if(r.length>Ce)throw new TypeError(`version is longer than ${Ce} characters`);te("SemVer",r,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const i=r.trim().match(t.loose?Oe[Be.LOOSE]:Oe[Be.FULL]);if(!i)throw new TypeError(`Invalid Version: ${r}`);if(this.raw=r,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>ie||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ie||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ie||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(a=>{if(/^[0-9]+$/.test(a)){const s=+a;if(s>=0&&s<ie)return s}return a}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(r){if(te("SemVer.compare",this.version,this.options,r),!(r instanceof A)){if(typeof r=="string"&&r===this.version)return 0;r=new A(r,this.options)}return r.version===this.version?0:this.compareMain(r)||this.comparePre(r)}compareMain(r){return r instanceof A||(r=new A(r,this.options)),U(this.major,r.major)||U(this.minor,r.minor)||U(this.patch,r.patch)}comparePre(r){if(r instanceof A||(r=new A(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;let t=0;do{const i=this.prerelease[t],a=r.prerelease[t];if(te("prerelease compare",t,i,a),i===void 0&&a===void 0)return 0;if(a===void 0)return 1;if(i===void 0)return-1;if(i===a)continue;return U(i,a)}while(++t)}compareBuild(r){r instanceof A||(r=new A(r,this.options));let t=0;do{const i=this.build[t],a=r.build[t];if(te("prerelease compare",t,i,a),i===void 0&&a===void 0)return 0;if(a===void 0)return 1;if(i===void 0)return-1;if(i===a)continue;return U(i,a)}while(++t)}inc(r,t,i){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,i),this.inc("pre",t,i);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,i),this.inc("pre",t,i);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const a=Number(i)?1:0;if(!t&&i===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[a];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&i===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(a)}}if(t){let s=[t,a];i===!1&&(s=[t]),U(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${r}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var Re=At;const De=Re,jt=(e,r,t=!1)=>{if(e instanceof De)return e;try{return new De(e,r)}catch(i){if(!t)return null;throw i}};var St=jt;const Lt=Re,$t=St,{safeRe:ne,t:ae}=Ye,Ft=(e,r)=>{if(e instanceof Lt)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;r=r||{};let t=null;if(!r.rtl)t=e.match(ne[ae.COERCE]);else{let i;for(;(i=ne[ae.COERCERTL].exec(e))&&(!t||t.index+t[0].length!==e.length);)(!t||i.index+i[0].length!==t.index+t[0].length)&&(t=i),ne[ae.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;ne[ae.COERCERTL].lastIndex=-1}return t===null?null:$t(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,r)};var Nt=Ft;const ze=Re,Mt=(e,r,t)=>new ze(e,t).compare(new ze(r,t));var _t=Mt;const Tt=_t,Ct=(e,r,t)=>Tt(e,r,t)>=0;var Ot=Ct;const er=()=>process.platform==="linux";let me=null;const Bt=()=>(me||(me=er()&&process.report?process.report.getReport():{}),me);var Dt={isLinux:er,getReport:Bt};const rr=R,zt="/usr/bin/ldd",qt=e=>rr.readFileSync(e,"utf-8"),Gt=e=>new Promise((r,t)=>{rr.readFile(e,"utf-8",(i,a)=>{i?t(i):r(a)})});var Ut={LDD_PATH:zt,readFileSync:qt,readFile:Gt};const tr=R,{isLinux:V,getReport:ir}=Dt,{LDD_PATH:de,readFile:nr,readFileSync:ar}=Ut;let j,S;const sr="getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true";let T="";const or=()=>T||new Promise(e=>{tr.exec(sr,(r,t)=>{T=r?" ":t,e(T)})}),lr=()=>{if(!T)try{T=tr.execSync(sr,{encoding:"utf8"})}catch{T=" "}return T},N="glibc",cr=/GLIBC\s(\d+\.\d+)/,z="musl",Ht=N.toUpperCase(),Xt=z.toLowerCase(),Wt=e=>e.includes("libc.musl-")||e.includes("ld-musl-"),hr=()=>{const e=ir();return e.header&&e.header.glibcVersionRuntime?N:Array.isArray(e.sharedObjects)&&e.sharedObjects.some(Wt)?z:null},fr=e=>{const[r,t]=e.split(/[\r\n]+/);return r&&r.includes(N)?N:t&&t.includes(z)?z:null},dr=e=>e.includes(Xt)?z:e.includes(Ht)?N:null,Vt=async()=>{if(j!==void 0)return j;j=null;try{const e=await nr(de);j=dr(e)}catch{}return j},Qt=()=>{if(j!==void 0)return j;j=null;try{const e=ar(de);j=dr(e)}catch{}return j},ur=async()=>{let e=null;if(V()&&(e=await Vt(),e||(e=hr()),!e)){const r=await or();e=fr(r)}return e},mr=()=>{let e=null;if(V()&&(e=Qt(),e||(e=hr()),!e)){const r=lr();e=fr(r)}return e},Kt=async()=>V()&&await ur()!==N,Jt=()=>V()&&mr()!==N,Yt=async()=>{if(S!==void 0)return S;S=null;try{const r=(await nr(de)).match(cr);r&&(S=r[1])}catch{}return S},Zt=()=>{if(S!==void 0)return S;S=null;try{const r=ar(de).match(cr);r&&(S=r[1])}catch{}return S},gr=()=>{const e=ir();return e.header&&e.header.glibcVersionRuntime?e.header.glibcVersionRuntime:null},qe=e=>e.trim().split(/\s+/)[1],br=e=>{const[r,t,i]=e.split(/[\r\n]+/);return r&&r.includes(N)?qe(r):t&&i&&t.includes(z)?qe(i):null},ei=async()=>{let e=null;if(V()&&(e=await Yt(),e||(e=gr()),!e)){const r=await or();e=br(r)}return e},ri=()=>{let e=null;if(V()&&(e=Zt(),e||(e=gr()),!e)){const r=lr();e=br(r)}return e};var pr={GLIBC:N,MUSL:z,family:ur,familySync:mr,isNonGlibcLinux:Kt,isNonGlibcLinuxSync:Jt,version:ei,versionSync:ri},wr={};const ge=pr,se=wr;var Ae=function(){const e=se.npm_config_arch||process.arch,r=se.npm_config_platform||process.platform,t=wr.npm_config_libc||(ge.isNonGlibcLinuxSync()?ge.familySync():""),i=r!=="linux"||t===ge.GLIBC?"":t,a=[`${r}${i}`];if(e==="arm"){const s=process.versions.electron?"7":"6";a.push(`armv${se.npm_config_arm_version||process.config.variables.arm_version||s}`)}else e==="arm64"?a.push(`arm64v${se.npm_config_arm_version||"8"}`):a.push(e);return a.join("-")};const ti="sharp",ii="High performance Node.js image processing, the fastest module to resize JPEG, PNG, WebP, GIF, AVIF and TIFF images",ni="0.32.6",ai="Lovell Fuller <npm@lovell.info>",si="https://github.com/lovell/sharp",oi=["Pierre Inglebert <pierre.inglebert@gmail.com>","Jonathan Ong <jonathanrichardong@gmail.com>","Chanon Sajjamanochai <chanon.s@gmail.com>","Juliano Julio <julianojulio@gmail.com>","Daniel Gasienica <daniel@gasienica.ch>","Julian Walker <julian@fiftythree.com>","Amit Pitaru <pitaru.amit@gmail.com>","Brandon Aaron <hello.brandon@aaron.sh>","Andreas Lind <andreas@one.com>","Maurus Cuelenaere <mcuelenaere@gmail.com>","Linus Unnebäck <linus@folkdatorn.se>","Victor Mateevitsi <mvictoras@gmail.com>","Alaric Holloway <alaric.holloway@gmail.com>","Bernhard K. Weisshuhn <bkw@codingforce.com>","Chris Riley <criley@primedia.com>","David Carley <dacarley@gmail.com>","John Tobin <john@limelightmobileinc.com>","Kenton Gray <kentongray@gmail.com>","Felix Bünemann <Felix.Buenemann@gmail.com>","Samy Al Zahrani <samyalzahrany@gmail.com>","Chintan Thakkar <lemnisk8@gmail.com>","F. Orlando Galashan <frulo@gmx.de>","Kleis Auke Wolthuizen <info@kleisauke.nl>","Matt Hirsch <mhirsch@media.mit.edu>","Matthias Thoemmes <thoemmes@gmail.com>","Patrick Paskaris <patrick@paskaris.gr>","Jérémy Lal <kapouer@melix.org>","Rahul Nanwani <r.nanwani@gmail.com>","Alice Monday <alice0meta@gmail.com>","Kristo Jorgenson <kristo.jorgenson@gmail.com>","YvesBos <yves_bos@outlook.com>","Guy Maliar <guy@tailorbrands.com>","Nicolas Coden <nicolas@ncoden.fr>","Matt Parrish <matt.r.parrish@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Matthew McEachen <matthew+github@mceachen.org>","Jarda Kotěšovec <jarda.kotesovec@gmail.com>","Kenric D'Souza <kenric.dsouza@gmail.com>","Oleh Aleinyk <oleg.aleynik@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Andrea Bianco <andrea.bianco@unibas.ch>","Rik Heywood <rik@rik.org>","Thomas Parisot <hi@oncletom.io>","Nathan Graves <nathanrgraves+github@gmail.com>","Tom Lokhorst <tom@lokhorst.eu>","Espen Hovlandsdal <espen@hovlandsdal.com>","Sylvain Dumont <sylvain.dumont35@gmail.com>","Alun Davies <alun.owain.davies@googlemail.com>","Aidan Hoolachan <ajhoolachan21@gmail.com>","Axel Eirola <axel.eirola@iki.fi>","Freezy <freezy@xbmc.org>","Daiz <taneli.vatanen@gmail.com>","Julian Aubourg <j@ubourg.net>","Keith Belovay <keith@picthrive.com>","Michael B. Klein <mbklein@gmail.com>","Jordan Prudhomme <jordan@raboland.fr>","Ilya Ovdin <iovdin@gmail.com>","Andargor <andargor@yahoo.com>","Paul Neave <paul.neave@gmail.com>","Brendan Kennedy <brenwken@gmail.com>","Brychan Bennett-Odlum <git@brychan.io>","Edward Silverton <e.silverton@gmail.com>","Roman Malieiev <aromaleev@gmail.com>","Tomas Szabo <tomas.szabo@deftomat.com>","Robert O'Rourke <robert@o-rourke.org>","Guillermo Alfonso Varela Chouciño <guillevch@gmail.com>","Christian Flintrup <chr@gigahost.dk>","Manan Jadhav <manan@motionden.com>","Leon Radley <leon@radley.se>","alza54 <alza54@thiocod.in>","Jacob Smith <jacob@frende.me>","Michael Nutt <michael@nutt.im>","Brad Parham <baparham@gmail.com>","Taneli Vatanen <taneli.vatanen@gmail.com>","Joris Dugué <zaruike10@gmail.com>","Chris Banks <christopher.bradley.banks@gmail.com>","Ompal Singh <ompal.hitm09@gmail.com>","Brodan <christopher.hranj@gmail.com","Ankur Parihar <ankur.github@gmail.com>","Brahim Ait elhaj <brahima@gmail.com>","Mart Jansink <m.jansink@gmail.com>","Lachlan Newman <lachnewman007@gmail.com>"],li={install:"(node install/libvips && node install/dll-copy && prebuild-install) || (node install/can-compile && node-gyp rebuild && node install/dll-copy)",clean:"rm -rf node_modules/ build/ vendor/ .nyc_output/ coverage/ test/fixtures/output.*",test:"npm run test-lint && npm run test-unit && npm run test-licensing && npm run test-types","test-lint":"semistandard && cpplint","test-unit":"nyc --reporter=lcov --reporter=text --check-coverage --branches=100 mocha","test-licensing":'license-checker --production --summary --onlyAllow="Apache-2.0;BSD;ISC;MIT"',"test-leak":"./test/leak/leak.sh","test-types":"tsd","docs-build":"node docs/build && node docs/search-index/build","docs-serve":"cd docs && npx serve","docs-publish":"cd docs && npx firebase-tools deploy --project pixelplumbing --only hosting:pixelplumbing-sharp"},ci="lib/index.js",hi="lib/index.d.ts",fi=["binding.gyp","install/**","lib/**","src/**"],di={type:"git",url:"git://github.com/lovell/sharp"},ui=["jpeg","png","webp","avif","tiff","gif","svg","jp2","dzi","image","resize","thumbnail","crop","embed","libvips","vips"],mi={color:"^4.2.3","detect-libc":"^2.0.2","node-addon-api":"^6.1.0","prebuild-install":"^7.1.1",semver:"^7.5.4","simple-get":"^4.0.1","tar-fs":"^3.0.4","tunnel-agent":"^0.6.0"},gi={"@types/node":"*",async:"^3.2.4",cc:"^3.0.1","exif-reader":"^1.2.0","extract-zip":"^2.0.1",icc:"^3.0.0","jsdoc-to-markdown":"^8.0.0","license-checker":"^25.0.1",mocha:"^10.2.0","mock-fs":"^5.2.0",nyc:"^15.1.0",prebuild:"^12.0.0",semistandard:"^16.0.1",tsd:"^0.29.0"},bi="Apache-2.0",pi={libvips:"8.14.5",integrity:{"darwin-arm64v8":"sha512-1QZzICfCJd4wAO0P6qmYI5e5VFMt9iCE4QgefI8VMMbdSzjIXA9L/ARN6pkMQPZ3h20Y9RtJ2W1skgCsvCIccw==","darwin-x64":"sha512-sMIKMYXsdU9FlIfztj6Kt/SfHlhlDpP0Ups7ftVFqwjaszmYmpI9y/d/q3mLb4jrzuSiSUEislSWCwBnW7MPTw==","linux-arm64v8":"sha512-CD8owELzkDumaom+O3jJ8fKamILAQdj+//KK/VNcHK3sngUcFpdjx36C8okwbux9sml/T7GTB/gzpvReDrAejQ==","linux-armv6":"sha512-wk6IPHatDFVWKJy7lI1TJezHGHPQut1wF2bwx256KlZwXUQU3fcVcMpV1zxXjgLFewHq2+uhyMkoSGBPahWzlA==","linux-armv7":"sha512-HEZC9KYtkmBK5rUR2MqBhrVarnQVZ/TwLUeLkKq0XuoM2pc/eXI6N0Fh5NGEFwdXI2XE8g1ySf+OYS6DDi+xCQ==","linux-x64":"sha512-SlFWrITSW5XVUkaFPQOySAaSGXnhkGJCj8X2wGYYta9hk5piZldQyMp4zwy0z6UeRu1qKTKtZvmq28W3Gnh9xA==","linuxmusl-arm64v8":"sha512-ga9iX7WUva3sG/VsKkOD318InLlCfPIztvzCZKZ2/+izQXRbQi8VoXWMHgEN4KHACv45FTl7mJ/8CRqUzhS8wQ==","linuxmusl-x64":"sha512-yeaHnpfee1hrZLok2l4eFceHzlfq8gN3QOu0R4Mh8iMK5O5vAUu97bdtxeZZeJJvHw8tfh2/msGi0qysxKN8bw==","win32-arm64v8":"sha512-kR91hy9w1+GEXK56hLh51+hBCBo7T+ijM4Slkmvb/2PsYZySq5H7s61n99iDYl6kTJP2y9sW5Xcvm3uuXDaDgg==","win32-ia32":"sha512-HrnofEbzHNpHJ0vVnjsTj5yfgVdcqdWshXuwFO2zc8xlEjA83BvXZ0lVj9MxPxkxJ2ta+/UlLr+CFzc5bOceMw==","win32-x64":"sha512-BwKckinJZ0Fu/EcunqiLPwOLEBWp4xf8GV7nvmVuKKz5f6B+GxoA2k9aa2wueqv4r4RJVgV/aWXZWFKOIjre/Q=="},runtime:"napi",target:7},wi={node:">=14.15.0"},yi={url:"https://opencollective.com/libvips"},vi={napi_versions:[7]},Ei={env:["mocha"]},xi={linelength:"120",filter:["build/include"]},Pi={directory:"test/types/"},yr={name:ti,description:ii,version:ni,author:ai,homepage:si,contributors:oi,scripts:li,main:ci,types:hi,files:fi,repository:di,keywords:ui,dependencies:mi,devDependencies:gi,license:bi,config:pi,engines:wi,funding:yi,binary:vi,semistandard:Ei,cc:xi,tsd:Pi};var Ii={};const je=R,ki=R,le=R,Se=R.spawnSync,Ri=Nt,Ai=Ot,ji=Ae,{config:vr}=yr,O=Ii,Er=O.npm_package_config_libvips||vr.libvips,Le=Ri(Er).version,$e={encoding:"utf8",shell:!0},xr=le.join(__dirname,"..","vendor",Le,ji()),ve=function(e){try{je.mkdirSync(e,{recursive:!0})}catch(r){if(r.code!=="EEXIST")throw r}},Si=function(){const e=O.npm_config_cache||(O.APPDATA?le.join(O.APPDATA,"npm-cache"):le.join(ki.homedir(),".npm"));ve(e);const r=le.join(e,"_libvips");return ve(r),r},Li=function(e){return O[`npm_package_config_integrity_${e.replace("-","_")}`]||vr.integrity[e]},Pr=function(e){e instanceof Error?console.error(`sharp: Installation error: ${e.message}`):console.log(`sharp: ${e}`)},$i=function(){return process.platform==="darwin"&&process.arch==="x64"?(Se("sysctl sysctl.proc_translated",$e).stdout||"").trim()==="sysctl.proc_translated: 1":!1},Ir=function(){return process.platform!=="win32"?(Se("pkg-config --modversion vips-cpp",{...$e,env:{...O,PKG_CONFIG_PATH:kr()}}).stdout||"").trim():""},Fi=function(){return je.existsSync(xr)},Ni=function(){je.rmSync(xr,{recursive:!0,maxRetries:3,force:!0})},kr=function(){return process.platform!=="win32"?[(Se('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',$e).stdout||"").trim(),O.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":"):""},Mi=function(){if(O.SHARP_IGNORE_GLOBAL_LIBVIPS)return!1;if($i())return Pr("Detected Rosetta, skipping search for globally-installed libvips"),!1;const e=Ir();return!!e&&Ai(e,Le)};var _i={minimumLibvipsVersion:Le,minimumLibvipsVersionLabelled:Er,cachePath:Si,integrity:Li,log:Pr,globalLibvipsVersion:Ir,hasVendoredLibvips:Fi,removeVendoredLibvips:Ni,pkgConfigPath:kr,useGlobalLibvips:Mi,mkdirSync:ve};function Rr(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ar={exports:{}};const be=Ae();try{Ar.exports=Rr(`../build/Release/sharp-${be}.node`)}catch(e){const r=["",'Something went wrong installing the "sharp" module',"",e.message,"","Possible solutions:"];if(/dylib/.test(e.message)&&/Incompatible library version/.test(e.message))r.push('- Update Homebrew: "brew update && brew upgrade vips"');else{const[t,i]=be.split("-");t==="linux"&&/Module did not self-register/.test(e.message)&&r.push("- Using worker threads? See https://sharp.pixelplumbing.com/install#worker-threads"),r.push('- Install with verbose logging and look for errors: "npm install --ignore-scripts=false --foreground-scripts --verbose sharp"',`- Install for the current ${be} runtime: "npm install --platform=${t} --arch=${i} sharp"`)}if(r.push("- Consult the installation documentation: https://sharp.pixelplumbing.com/install"),process.platform==="win32"||/symbol/.test(e.message)){const t=Object.keys(require.cache).find(i=>/[\\/]build[\\/]Release[\\/]sharp(.*)\.node$/.test(i));if(t){const[,i]=t.match(/node_modules[\\/]([^\\/]+)[\\/]/);r.push(`- Ensure the version of sharp aligns with the ${i} package: "npm ls sharp"`)}}throw new Error(r.join(`
`))}var Fe=Ar.exports;const Ti=R,Ne=R,Ci=M;_i.hasVendoredLibvips();const Oi=Ti.debuglog("sharp"),D=function(e,r){if(arguments.length===1&&!Ci.defined(e))throw new Error("Invalid input");return this instanceof D?(Ne.Duplex.call(this),this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],useExifOrientation:!1,angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBeforePreExtract:!1,flip:!1,flop:!1,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:!1,withoutReduction:!1,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:!0,tintA:128,tintB:128,flatten:!1,flattenBackground:[0,0,0],unflatten:!1,negate:!1,negateAlpha:!0,medianSize:0,blurSigma:0,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:!0,trimBackground:[],trimThreshold:0,gamma:0,gammaOut:0,greyscale:!1,normalise:!1,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:!1,ensureAlpha:-1,colourspace:"srgb",colourspaceInput:"last",composite:[],fileOut:"",formatOut:"input",streamOut:!1,withMetadata:!1,withMetadataOrientation:-1,withMetadataDensity:0,withMetadataIcc:"",withMetadataStrs:{},resolveWithObject:!1,jpegQuality:80,jpegProgressive:!1,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:!1,jpegOvershootDeringing:!1,jpegOptimiseScans:!1,jpegOptimiseCoding:!0,jpegQuantisationTable:0,pngProgressive:!1,pngCompressionLevel:6,pngAdaptiveFiltering:!1,pngPalette:!1,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:!1,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:!1,webpNearLossless:!1,webpSmartSubsample:!1,webpPreset:"default",webpEffort:4,webpMinSize:!1,webpMixed:!1,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifReuse:!0,gifProgressive:!1,tiffQuality:80,tiffCompression:"jpeg",tiffPredictor:"horizontal",tiffPyramid:!1,tiffBitdepth:8,tiffTile:!1,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:!1,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:!1,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:!1,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],debuglog:t=>{this.emit("warning",t),Oi(t)},queueListener:function(t){D.queue.emit("change",t)}},this.options.input=this._createInputDescriptor(e,r,{allowStream:!0}),this):new D(e,r)};Object.setPrototypeOf(D.prototype,Ne.Duplex.prototype);Object.setPrototypeOf(D,Ne.Duplex);function Bi(){const e=this.constructor.call();return e.options=Object.assign({},this.options),this._isStreamInput()&&this.on("finish",()=>{this._flattenBufferIn(),e.options.bufferIn=this.options.bufferIn,e.emit("finish")}),e}Object.assign(D.prototype,{clone:Bi});var Di=D,jr={exports:{}},zi={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Sr={exports:{}},qi=function(r){return!r||typeof r=="string"?!1:r instanceof Array||Array.isArray(r)||r.length>=0&&(r.splice instanceof Function||Object.getOwnPropertyDescriptor(r,r.length-1)&&r.constructor.name!=="String")},Gi=qi,Ui=Array.prototype.concat,Hi=Array.prototype.slice,Ge=Sr.exports=function(r){for(var t=[],i=0,a=r.length;i<a;i++){var s=r[i];Gi(s)?t=Ui.call(t,Hi.call(s)):t.push(s)}return t};Ge.wrap=function(e){return function(){return e(Ge(arguments))}};var Xi=Sr.exports,J=zi,ee=Xi,Lr=Object.hasOwnProperty,$r=Object.create(null);for(var pe in J)Lr.call(J,pe)&&($r[J[pe]]=pe);var P=jr.exports={to:{},get:{}};P.get=function(e){var r=e.substring(0,3).toLowerCase(),t,i;switch(r){case"hsl":t=P.get.hsl(e),i="hsl";break;case"hwb":t=P.get.hwb(e),i="hwb";break;default:t=P.get.rgb(e),i="rgb";break}return t?{model:i,value:t}:null};P.get.rgb=function(e){if(!e)return null;var r=/^#([a-f0-9]{3,4})$/i,t=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,i=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,a=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,s=/^(\w+)$/,c=[0,0,0,1],f,l,d;if(f=e.match(t)){for(d=f[2],f=f[1],l=0;l<3;l++){var w=l*2;c[l]=parseInt(f.slice(w,w+2),16)}d&&(c[3]=parseInt(d,16)/255)}else if(f=e.match(r)){for(f=f[1],d=f[3],l=0;l<3;l++)c[l]=parseInt(f[l]+f[l],16);d&&(c[3]=parseInt(d+d,16)/255)}else if(f=e.match(i)){for(l=0;l<3;l++)c[l]=parseInt(f[l+1],0);f[4]&&(f[5]?c[3]=parseFloat(f[4])*.01:c[3]=parseFloat(f[4]))}else if(f=e.match(a)){for(l=0;l<3;l++)c[l]=Math.round(parseFloat(f[l+1])*2.55);f[4]&&(f[5]?c[3]=parseFloat(f[4])*.01:c[3]=parseFloat(f[4]))}else return(f=e.match(s))?f[1]==="transparent"?[0,0,0,0]:Lr.call(J,f[1])?(c=J[f[1]],c[3]=1,c):null:null;for(l=0;l<3;l++)c[l]=B(c[l],0,255);return c[3]=B(c[3],0,1),c};P.get.hsl=function(e){if(!e)return null;var r=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=e.match(r);if(t){var i=parseFloat(t[4]),a=(parseFloat(t[1])%360+360)%360,s=B(parseFloat(t[2]),0,100),c=B(parseFloat(t[3]),0,100),f=B(isNaN(i)?1:i,0,1);return[a,s,c,f]}return null};P.get.hwb=function(e){if(!e)return null;var r=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=e.match(r);if(t){var i=parseFloat(t[4]),a=(parseFloat(t[1])%360+360)%360,s=B(parseFloat(t[2]),0,100),c=B(parseFloat(t[3]),0,100),f=B(isNaN(i)?1:i,0,1);return[a,s,c,f]}return null};P.to.hex=function(){var e=ee(arguments);return"#"+oe(e[0])+oe(e[1])+oe(e[2])+(e[3]<1?oe(Math.round(e[3]*255)):"")};P.to.rgb=function(){var e=ee(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"};P.to.rgb.percent=function(){var e=ee(arguments),r=Math.round(e[0]/255*100),t=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+r+"%, "+t+"%, "+i+"%)":"rgba("+r+"%, "+t+"%, "+i+"%, "+e[3]+")"};P.to.hsl=function(){var e=ee(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"};P.to.hwb=function(){var e=ee(arguments),r="";return e.length>=4&&e[3]!==1&&(r=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+r+")"};P.to.keyword=function(e){return $r[e.slice(0,3)]};function B(e,r,t){return Math.min(Math.max(r,e),t)}function oe(e){var r=Math.round(e).toString(16).toUpperCase();return r.length<2?"0"+r:r}var Wi=jr.exports,Vi={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const Y=Vi,Fr={};for(const e of Object.keys(Y))Fr[Y[e]]=e;const u={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var Nr=u;for(const e of Object.keys(u)){if(!("channels"in u[e]))throw new Error("missing channels property: "+e);if(!("labels"in u[e]))throw new Error("missing channel labels property: "+e);if(u[e].labels.length!==u[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:r,labels:t}=u[e];delete u[e].channels,delete u[e].labels,Object.defineProperty(u[e],"channels",{value:r}),Object.defineProperty(u[e],"labels",{value:t})}u.rgb.hsl=function(e){const r=e[0]/255,t=e[1]/255,i=e[2]/255,a=Math.min(r,t,i),s=Math.max(r,t,i),c=s-a;let f,l;s===a?f=0:r===s?f=(t-i)/c:t===s?f=2+(i-r)/c:i===s&&(f=4+(r-t)/c),f=Math.min(f*60,360),f<0&&(f+=360);const d=(a+s)/2;return s===a?l=0:d<=.5?l=c/(s+a):l=c/(2-s-a),[f,l*100,d*100]};u.rgb.hsv=function(e){let r,t,i,a,s;const c=e[0]/255,f=e[1]/255,l=e[2]/255,d=Math.max(c,f,l),w=d-Math.min(c,f,l),v=function(q){return(d-q)/6/w+1/2};return w===0?(a=0,s=0):(s=w/d,r=v(c),t=v(f),i=v(l),c===d?a=i-t:f===d?a=1/3+r-i:l===d&&(a=2/3+t-r),a<0?a+=1:a>1&&(a-=1)),[a*360,s*100,d*100]};u.rgb.hwb=function(e){const r=e[0],t=e[1];let i=e[2];const a=u.rgb.hsl(e)[0],s=1/255*Math.min(r,Math.min(t,i));return i=1-1/255*Math.max(r,Math.max(t,i)),[a,s*100,i*100]};u.rgb.cmyk=function(e){const r=e[0]/255,t=e[1]/255,i=e[2]/255,a=Math.min(1-r,1-t,1-i),s=(1-r-a)/(1-a)||0,c=(1-t-a)/(1-a)||0,f=(1-i-a)/(1-a)||0;return[s*100,c*100,f*100,a*100]};function Qi(e,r){return(e[0]-r[0])**2+(e[1]-r[1])**2+(e[2]-r[2])**2}u.rgb.keyword=function(e){const r=Fr[e];if(r)return r;let t=1/0,i;for(const a of Object.keys(Y)){const s=Y[a],c=Qi(e,s);c<t&&(t=c,i=a)}return i};u.keyword.rgb=function(e){return Y[e]};u.rgb.xyz=function(e){let r=e[0]/255,t=e[1]/255,i=e[2]/255;r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92;const a=r*.4124+t*.3576+i*.1805,s=r*.2126+t*.7152+i*.0722,c=r*.0193+t*.1192+i*.9505;return[a*100,s*100,c*100]};u.rgb.lab=function(e){const r=u.rgb.xyz(e);let t=r[0],i=r[1],a=r[2];t/=95.047,i/=100,a/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,a=a>.008856?a**(1/3):7.787*a+16/116;const s=116*i-16,c=500*(t-i),f=200*(i-a);return[s,c,f]};u.hsl.rgb=function(e){const r=e[0]/360,t=e[1]/100,i=e[2]/100;let a,s,c;if(t===0)return c=i*255,[c,c,c];i<.5?a=i*(1+t):a=i+t-i*t;const f=2*i-a,l=[0,0,0];for(let d=0;d<3;d++)s=r+1/3*-(d-1),s<0&&s++,s>1&&s--,6*s<1?c=f+(a-f)*6*s:2*s<1?c=a:3*s<2?c=f+(a-f)*(2/3-s)*6:c=f,l[d]=c*255;return l};u.hsl.hsv=function(e){const r=e[0];let t=e[1]/100,i=e[2]/100,a=t;const s=Math.max(i,.01);i*=2,t*=i<=1?i:2-i,a*=s<=1?s:2-s;const c=(i+t)/2,f=i===0?2*a/(s+a):2*t/(i+t);return[r,f*100,c*100]};u.hsv.rgb=function(e){const r=e[0]/60,t=e[1]/100;let i=e[2]/100;const a=Math.floor(r)%6,s=r-Math.floor(r),c=255*i*(1-t),f=255*i*(1-t*s),l=255*i*(1-t*(1-s));switch(i*=255,a){case 0:return[i,l,c];case 1:return[f,i,c];case 2:return[c,i,l];case 3:return[c,f,i];case 4:return[l,c,i];case 5:return[i,c,f]}};u.hsv.hsl=function(e){const r=e[0],t=e[1]/100,i=e[2]/100,a=Math.max(i,.01);let s,c;c=(2-t)*i;const f=(2-t)*a;return s=t*a,s/=f<=1?f:2-f,s=s||0,c/=2,[r,s*100,c*100]};u.hwb.rgb=function(e){const r=e[0]/360;let t=e[1]/100,i=e[2]/100;const a=t+i;let s;a>1&&(t/=a,i/=a);const c=Math.floor(6*r),f=1-i;s=6*r-c,c&1&&(s=1-s);const l=t+s*(f-t);let d,w,v;switch(c){default:case 6:case 0:d=f,w=l,v=t;break;case 1:d=l,w=f,v=t;break;case 2:d=t,w=f,v=l;break;case 3:d=t,w=l,v=f;break;case 4:d=l,w=t,v=f;break;case 5:d=f,w=t,v=l;break}return[d*255,w*255,v*255]};u.cmyk.rgb=function(e){const r=e[0]/100,t=e[1]/100,i=e[2]/100,a=e[3]/100,s=1-Math.min(1,r*(1-a)+a),c=1-Math.min(1,t*(1-a)+a),f=1-Math.min(1,i*(1-a)+a);return[s*255,c*255,f*255]};u.xyz.rgb=function(e){const r=e[0]/100,t=e[1]/100,i=e[2]/100;let a,s,c;return a=r*3.2406+t*-1.5372+i*-.4986,s=r*-.9689+t*1.8758+i*.0415,c=r*.0557+t*-.204+i*1.057,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,c=c>.0031308?1.055*c**(1/2.4)-.055:c*12.92,a=Math.min(Math.max(0,a),1),s=Math.min(Math.max(0,s),1),c=Math.min(Math.max(0,c),1),[a*255,s*255,c*255]};u.xyz.lab=function(e){let r=e[0],t=e[1],i=e[2];r/=95.047,t/=100,i/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,t=t>.008856?t**(1/3):7.787*t+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;const a=116*t-16,s=500*(r-t),c=200*(t-i);return[a,s,c]};u.lab.xyz=function(e){const r=e[0],t=e[1],i=e[2];let a,s,c;s=(r+16)/116,a=t/500+s,c=s-i/200;const f=s**3,l=a**3,d=c**3;return s=f>.008856?f:(s-16/116)/7.787,a=l>.008856?l:(a-16/116)/7.787,c=d>.008856?d:(c-16/116)/7.787,a*=95.047,s*=100,c*=108.883,[a,s,c]};u.lab.lch=function(e){const r=e[0],t=e[1],i=e[2];let a;a=Math.atan2(i,t)*360/2/Math.PI,a<0&&(a+=360);const c=Math.sqrt(t*t+i*i);return[r,c,a]};u.lch.lab=function(e){const r=e[0],t=e[1],a=e[2]/360*2*Math.PI,s=t*Math.cos(a),c=t*Math.sin(a);return[r,s,c]};u.rgb.ansi16=function(e,r=null){const[t,i,a]=e;let s=r===null?u.rgb.hsv(e)[2]:r;if(s=Math.round(s/50),s===0)return 30;let c=30+(Math.round(a/255)<<2|Math.round(i/255)<<1|Math.round(t/255));return s===2&&(c+=60),c};u.hsv.ansi16=function(e){return u.rgb.ansi16(u.hsv.rgb(e),e[2])};u.rgb.ansi256=function(e){const r=e[0],t=e[1],i=e[2];return r===t&&t===i?r<8?16:r>248?231:Math.round((r-8)/247*24)+232:16+36*Math.round(r/255*5)+6*Math.round(t/255*5)+Math.round(i/255*5)};u.ansi16.rgb=function(e){let r=e%10;if(r===0||r===7)return e>50&&(r+=3.5),r=r/10.5*255,[r,r,r];const t=(~~(e>50)+1)*.5,i=(r&1)*t*255,a=(r>>1&1)*t*255,s=(r>>2&1)*t*255;return[i,a,s]};u.ansi256.rgb=function(e){if(e>=232){const s=(e-232)*10+8;return[s,s,s]}e-=16;let r;const t=Math.floor(e/36)/5*255,i=Math.floor((r=e%36)/6)/5*255,a=r%6/5*255;return[t,i,a]};u.rgb.hex=function(e){const t=(((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255)).toString(16).toUpperCase();return"000000".substring(t.length)+t};u.hex.rgb=function(e){const r=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!r)return[0,0,0];let t=r[0];r[0].length===3&&(t=t.split("").map(f=>f+f).join(""));const i=parseInt(t,16),a=i>>16&255,s=i>>8&255,c=i&255;return[a,s,c]};u.rgb.hcg=function(e){const r=e[0]/255,t=e[1]/255,i=e[2]/255,a=Math.max(Math.max(r,t),i),s=Math.min(Math.min(r,t),i),c=a-s;let f,l;return c<1?f=s/(1-c):f=0,c<=0?l=0:a===r?l=(t-i)/c%6:a===t?l=2+(i-r)/c:l=4+(r-t)/c,l/=6,l%=1,[l*360,c*100,f*100]};u.hsl.hcg=function(e){const r=e[1]/100,t=e[2]/100,i=t<.5?2*r*t:2*r*(1-t);let a=0;return i<1&&(a=(t-.5*i)/(1-i)),[e[0],i*100,a*100]};u.hsv.hcg=function(e){const r=e[1]/100,t=e[2]/100,i=r*t;let a=0;return i<1&&(a=(t-i)/(1-i)),[e[0],i*100,a*100]};u.hcg.rgb=function(e){const r=e[0]/360,t=e[1]/100,i=e[2]/100;if(t===0)return[i*255,i*255,i*255];const a=[0,0,0],s=r%1*6,c=s%1,f=1-c;let l=0;switch(Math.floor(s)){case 0:a[0]=1,a[1]=c,a[2]=0;break;case 1:a[0]=f,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=c;break;case 3:a[0]=0,a[1]=f,a[2]=1;break;case 4:a[0]=c,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=f}return l=(1-t)*i,[(t*a[0]+l)*255,(t*a[1]+l)*255,(t*a[2]+l)*255]};u.hcg.hsv=function(e){const r=e[1]/100,t=e[2]/100,i=r+t*(1-r);let a=0;return i>0&&(a=r/i),[e[0],a*100,i*100]};u.hcg.hsl=function(e){const r=e[1]/100,i=e[2]/100*(1-r)+.5*r;let a=0;return i>0&&i<.5?a=r/(2*i):i>=.5&&i<1&&(a=r/(2*(1-i))),[e[0],a*100,i*100]};u.hcg.hwb=function(e){const r=e[1]/100,t=e[2]/100,i=r+t*(1-r);return[e[0],(i-r)*100,(1-i)*100]};u.hwb.hcg=function(e){const r=e[1]/100,i=1-e[2]/100,a=i-r;let s=0;return a<1&&(s=(i-a)/(1-a)),[e[0],a*100,s*100]};u.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};u.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};u.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};u.gray.hsl=function(e){return[0,0,e[0]]};u.gray.hsv=u.gray.hsl;u.gray.hwb=function(e){return[0,100,e[0]]};u.gray.cmyk=function(e){return[0,0,0,e[0]]};u.gray.lab=function(e){return[e[0],0,0]};u.gray.hex=function(e){const r=Math.round(e[0]/100*255)&255,i=((r<<16)+(r<<8)+r).toString(16).toUpperCase();return"000000".substring(i.length)+i};u.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]};const ce=Nr;function Ki(){const e={},r=Object.keys(ce);for(let t=r.length,i=0;i<t;i++)e[r[i]]={distance:-1,parent:null};return e}function Ji(e){const r=Ki(),t=[e];for(r[e].distance=0;t.length;){const i=t.pop(),a=Object.keys(ce[i]);for(let s=a.length,c=0;c<s;c++){const f=a[c],l=r[f];l.distance===-1&&(l.distance=r[i].distance+1,l.parent=i,t.unshift(f))}}return r}function Yi(e,r){return function(t){return r(e(t))}}function Zi(e,r){const t=[r[e].parent,e];let i=ce[r[e].parent][e],a=r[e].parent;for(;r[a].parent;)t.unshift(r[a].parent),i=Yi(ce[r[a].parent][a],i),a=r[a].parent;return i.conversion=t,i}var en=function(e){const r=Ji(e),t={},i=Object.keys(r);for(let a=i.length,s=0;s<a;s++){const c=i[s];r[c].parent!==null&&(t[c]=Zi(c,r))}return t};const Ee=Nr,rn=en,X={},tn=Object.keys(Ee);function nn(e){const r=function(...t){const i=t[0];return i==null?i:(i.length>1&&(t=i),e(t))};return"conversion"in e&&(r.conversion=e.conversion),r}function an(e){const r=function(...t){const i=t[0];if(i==null)return i;i.length>1&&(t=i);const a=e(t);if(typeof a=="object")for(let s=a.length,c=0;c<s;c++)a[c]=Math.round(a[c]);return a};return"conversion"in e&&(r.conversion=e.conversion),r}tn.forEach(e=>{X[e]={},Object.defineProperty(X[e],"channels",{value:Ee[e].channels}),Object.defineProperty(X[e],"labels",{value:Ee[e].labels});const r=rn(e);Object.keys(r).forEach(i=>{const a=r[i];X[e][i]=an(a),X[e][i].raw=nn(a)})});var sn=X;const W=Wi,x=sn,Mr=["keyword","gray","hex"],xe={};for(const e of Object.keys(x))xe[[...x[e].labels].sort().join("")]=e;const he={};function E(e,r){if(!(this instanceof E))return new E(e,r);if(r&&r in Mr&&(r=null),r&&!(r in x))throw new Error("Unknown model: "+r);let t,i;if(e==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof E)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if(typeof e=="string"){const a=W.get(e);if(a===null)throw new Error("Unable to parse color from string: "+e);this.model=a.model,i=x[this.model].channels,this.color=a.value.slice(0,i),this.valpha=typeof a.value[i]=="number"?a.value[i]:1}else if(e.length>0){this.model=r||"rgb",i=x[this.model].channels;const a=Array.prototype.slice.call(e,0,i);this.color=Pe(a,i),this.valpha=typeof e[i]=="number"?e[i]:1}else if(typeof e=="number")this.model="rgb",this.color=[e>>16&255,e>>8&255,e&255],this.valpha=1;else{this.valpha=1;const a=Object.keys(e);"alpha"in e&&(a.splice(a.indexOf("alpha"),1),this.valpha=typeof e.alpha=="number"?e.alpha:0);const s=a.sort().join("");if(!(s in xe))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=xe[s];const{labels:c}=x[this.model],f=[];for(t=0;t<c.length;t++)f.push(e[c[t]]);this.color=Pe(f)}if(he[this.model])for(i=x[this.model].channels,t=0;t<i;t++){const a=he[this.model][t];a&&(this.color[t]=a(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}E.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let r=this.model in W.to?this:this.rgb();r=r.round(typeof e=="number"?e:1);const t=r.valpha===1?r.color:[...r.color,this.valpha];return W.to[r.model](t)},percentString(e){const r=this.rgb().round(typeof e=="number"?e:1),t=r.valpha===1?r.color:[...r.color,this.valpha];return W.to.rgb.percent(t)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const e={},{channels:r}=x[this.model],{labels:t}=x[this.model];for(let i=0;i<r;i++)e[t[i]]=this.color[i];return this.valpha!==1&&(e.alpha=this.valpha),e},unitArray(){const e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,this.valpha!==1&&e.push(this.valpha),e},unitObject(){const e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,this.valpha!==1&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new E([...this.color.map(ln(e)),this.valpha],this.model)},alpha(e){return e!==void 0?new E([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:p("rgb",0,y(255)),green:p("rgb",1,y(255)),blue:p("rgb",2,y(255)),hue:p(["hsl","hsv","hsl","hwb","hcg"],0,e=>(e%360+360)%360),saturationl:p("hsl",1,y(100)),lightness:p("hsl",2,y(100)),saturationv:p("hsv",1,y(100)),value:p("hsv",2,y(100)),chroma:p("hcg",1,y(100)),gray:p("hcg",2,y(100)),white:p("hwb",1,y(100)),wblack:p("hwb",2,y(100)),cyan:p("cmyk",0,y(100)),magenta:p("cmyk",1,y(100)),yellow:p("cmyk",2,y(100)),black:p("cmyk",3,y(100)),x:p("xyz",0,y(95.047)),y:p("xyz",1,y(100)),z:p("xyz",2,y(108.833)),l:p("lab",0,y(100)),a:p("lab",1),b:p("lab",2),keyword(e){return e!==void 0?new E(e):x[this.model].keyword(this.color)},hex(e){return e!==void 0?new E(e):W.to.hex(this.rgb().round().color)},hexa(e){if(e!==void 0)return new E(e);const r=this.rgb().round().color;let t=Math.round(this.valpha*255).toString(16).toUpperCase();return t.length===1&&(t="0"+t),W.to.hex(r)+t},rgbNumber(){const e=this.rgb().color;return(e[0]&255)<<16|(e[1]&255)<<8|e[2]&255},luminosity(){const e=this.rgb().color,r=[];for(const[t,i]of e.entries()){const a=i/255;r[t]=a<=.04045?a/12.92:((a+.055)/1.055)**2.4}return .2126*r[0]+.7152*r[1]+.0722*r[2]},contrast(e){const r=this.luminosity(),t=e.luminosity();return r>t?(r+.05)/(t+.05):(t+.05)/(r+.05)},level(e){const r=this.contrast(e);return r>=7?"AAA":r>=4.5?"AA":""},isDark(){const e=this.rgb().color;return(e[0]*2126+e[1]*7152+e[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let r=0;r<3;r++)e.color[r]=255-e.color[r];return e},lighten(e){const r=this.hsl();return r.color[2]+=r.color[2]*e,r},darken(e){const r=this.hsl();return r.color[2]-=r.color[2]*e,r},saturate(e){const r=this.hsl();return r.color[1]+=r.color[1]*e,r},desaturate(e){const r=this.hsl();return r.color[1]-=r.color[1]*e,r},whiten(e){const r=this.hwb();return r.color[1]+=r.color[1]*e,r},blacken(e){const r=this.hwb();return r.color[2]+=r.color[2]*e,r},grayscale(){const e=this.rgb().color,r=e[0]*.3+e[1]*.59+e[2]*.11;return E.rgb(r,r,r)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const r=this.hsl();let t=r.color[0];return t=(t+e)%360,t=t<0?360+t:t,r.color[0]=t,r},mix(e,r){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);const t=e.rgb(),i=this.rgb(),a=r===void 0?.5:r,s=2*a-1,c=t.alpha()-i.alpha(),f=((s*c===-1?s:(s+c)/(1+s*c))+1)/2,l=1-f;return E.rgb(f*t.red()+l*i.red(),f*t.green()+l*i.green(),f*t.blue()+l*i.blue(),t.alpha()*a+i.alpha()*(1-a))}};for(const e of Object.keys(x)){if(Mr.includes(e))continue;const{channels:r}=x[e];E.prototype[e]=function(...t){return this.model===e?new E(this):t.length>0?new E(t,e):new E([...cn(x[this.model][e].raw(this.color)),this.valpha],e)},E[e]=function(...t){let i=t[0];return typeof i=="number"&&(i=Pe(t,r)),new E(i,e)}}function on(e,r){return Number(e.toFixed(r))}function ln(e){return function(r){return on(r,e)}}function p(e,r,t){e=Array.isArray(e)?e:[e];for(const i of e)(he[i]||(he[i]=[]))[r]=t;return e=e[0],function(i){let a;return i!==void 0?(t&&(i=t(i)),a=this[e](),a.color[r]=i,a):(a=this[e]().color[r],t&&(a=t(a)),a)}}function y(e){return function(r){return Math.max(0,Math.min(e,r))}}function cn(e){return Array.isArray(e)?e:[e]}function Pe(e,r){for(let t=0;t<r;t++)typeof e[t]!="number"&&(e[t]=0);return e}var Me=E;const hn=Me,h=M,C=Fe,fn={left:"low",center:"centre",centre:"centre",right:"high"};function _r(e){const{raw:r,density:t,limitInputPixels:i,ignoreIcc:a,unlimited:s,sequentialRead:c,failOn:f,failOnError:l,animated:d,page:w,pages:v,subifd:q}=e;return[r,t,i,a,s,c,f,l,d,w,v,q].some(h.defined)?{raw:r,density:t,limitInputPixels:i,ignoreIcc:a,unlimited:s,sequentialRead:c,failOn:f,failOnError:l,animated:d,page:w,pages:v,subifd:q}:void 0}function dn(e,r,t){const i={failOn:"warning",limitInputPixels:Math.pow(16383,2),ignoreIcc:!1,unlimited:!1,sequentialRead:!0};if(h.string(e))i.file=e;else if(h.buffer(e)){if(e.length===0)throw Error("Input Buffer is empty");i.buffer=e}else if(h.arrayBuffer(e)){if(e.byteLength===0)throw Error("Input bit Array is empty");i.buffer=Buffer.from(e,0,e.byteLength)}else if(h.typedArray(e)){if(e.length===0)throw Error("Input Bit Array is empty");i.buffer=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}else if(h.plainObject(e)&&!h.defined(r))r=e,_r(r)&&(i.buffer=[]);else if(!h.defined(e)&&!h.defined(r)&&h.object(t)&&t.allowStream)i.buffer=[];else throw new Error(`Unsupported input '${e}' of type ${typeof e}${h.defined(r)?` when also providing options of type ${typeof r}`:""}`);if(h.object(r)){if(h.defined(r.failOnError))if(h.bool(r.failOnError))i.failOn=r.failOnError?"warning":"none";else throw h.invalidParameterError("failOnError","boolean",r.failOnError);if(h.defined(r.failOn))if(h.string(r.failOn)&&h.inArray(r.failOn,["none","truncated","error","warning"]))i.failOn=r.failOn;else throw h.invalidParameterError("failOn","one of: none, truncated, error, warning",r.failOn);if(h.defined(r.density))if(h.inRange(r.density,1,1e5))i.density=r.density;else throw h.invalidParameterError("density","number between 1 and 100000",r.density);if(h.defined(r.ignoreIcc))if(h.bool(r.ignoreIcc))i.ignoreIcc=r.ignoreIcc;else throw h.invalidParameterError("ignoreIcc","boolean",r.ignoreIcc);if(h.defined(r.limitInputPixels))if(h.bool(r.limitInputPixels))i.limitInputPixels=r.limitInputPixels?Math.pow(16383,2):0;else if(h.integer(r.limitInputPixels)&&h.inRange(r.limitInputPixels,0,Number.MAX_SAFE_INTEGER))i.limitInputPixels=r.limitInputPixels;else throw h.invalidParameterError("limitInputPixels","positive integer",r.limitInputPixels);if(h.defined(r.unlimited))if(h.bool(r.unlimited))i.unlimited=r.unlimited;else throw h.invalidParameterError("unlimited","boolean",r.unlimited);if(h.defined(r.sequentialRead))if(h.bool(r.sequentialRead))i.sequentialRead=r.sequentialRead;else throw h.invalidParameterError("sequentialRead","boolean",r.sequentialRead);if(h.defined(r.raw))if(h.object(r.raw)&&h.integer(r.raw.width)&&r.raw.width>0&&h.integer(r.raw.height)&&r.raw.height>0&&h.integer(r.raw.channels)&&h.inRange(r.raw.channels,1,4))switch(i.rawWidth=r.raw.width,i.rawHeight=r.raw.height,i.rawChannels=r.raw.channels,i.rawPremultiplied=!!r.raw.premultiplied,e.constructor){case Uint8Array:case Uint8ClampedArray:i.rawDepth="uchar";break;case Int8Array:i.rawDepth="char";break;case Uint16Array:i.rawDepth="ushort";break;case Int16Array:i.rawDepth="short";break;case Uint32Array:i.rawDepth="uint";break;case Int32Array:i.rawDepth="int";break;case Float32Array:i.rawDepth="float";break;case Float64Array:i.rawDepth="double";break;default:i.rawDepth="uchar";break}else throw new Error("Expected width, height and channels for raw pixel input");if(h.defined(r.animated))if(h.bool(r.animated))i.pages=r.animated?-1:1;else throw h.invalidParameterError("animated","boolean",r.animated);if(h.defined(r.pages))if(h.integer(r.pages)&&h.inRange(r.pages,-1,1e5))i.pages=r.pages;else throw h.invalidParameterError("pages","integer between -1 and 100000",r.pages);if(h.defined(r.page))if(h.integer(r.page)&&h.inRange(r.page,0,1e5))i.page=r.page;else throw h.invalidParameterError("page","integer between 0 and 100000",r.page);if(h.defined(r.level))if(h.integer(r.level)&&h.inRange(r.level,0,256))i.level=r.level;else throw h.invalidParameterError("level","integer between 0 and 256",r.level);if(h.defined(r.subifd))if(h.integer(r.subifd)&&h.inRange(r.subifd,-1,1e5))i.subifd=r.subifd;else throw h.invalidParameterError("subifd","integer between -1 and 100000",r.subifd);if(h.defined(r.create))if(h.object(r.create)&&h.integer(r.create.width)&&r.create.width>0&&h.integer(r.create.height)&&r.create.height>0&&h.integer(r.create.channels)){if(i.createWidth=r.create.width,i.createHeight=r.create.height,i.createChannels=r.create.channels,h.defined(r.create.noise)){if(!h.object(r.create.noise))throw new Error("Expected noise to be an object");if(!h.inArray(r.create.noise.type,["gaussian"]))throw new Error("Only gaussian noise is supported at the moment");if(!h.inRange(r.create.channels,1,4))throw h.invalidParameterError("create.channels","number between 1 and 4",r.create.channels);if(i.createNoiseType=r.create.noise.type,h.number(r.create.noise.mean)&&h.inRange(r.create.noise.mean,0,1e4))i.createNoiseMean=r.create.noise.mean;else throw h.invalidParameterError("create.noise.mean","number between 0 and 10000",r.create.noise.mean);if(h.number(r.create.noise.sigma)&&h.inRange(r.create.noise.sigma,0,1e4))i.createNoiseSigma=r.create.noise.sigma;else throw h.invalidParameterError("create.noise.sigma","number between 0 and 10000",r.create.noise.sigma)}else if(h.defined(r.create.background)){if(!h.inRange(r.create.channels,3,4))throw h.invalidParameterError("create.channels","number between 3 and 4",r.create.channels);const a=hn(r.create.background);i.createBackground=[a.red(),a.green(),a.blue(),Math.round(a.alpha()*255)]}else throw new Error("Expected valid noise or background to create a new input image");delete i.buffer}else throw new Error("Expected valid width, height and channels to create a new input image");if(h.defined(r.text))if(h.object(r.text)&&h.string(r.text.text)){if(i.textValue=r.text.text,h.defined(r.text.height)&&h.defined(r.text.dpi))throw new Error("Expected only one of dpi or height");if(h.defined(r.text.font))if(h.string(r.text.font))i.textFont=r.text.font;else throw h.invalidParameterError("text.font","string",r.text.font);if(h.defined(r.text.fontfile))if(h.string(r.text.fontfile))i.textFontfile=r.text.fontfile;else throw h.invalidParameterError("text.fontfile","string",r.text.fontfile);if(h.defined(r.text.width))if(h.number(r.text.width))i.textWidth=r.text.width;else throw h.invalidParameterError("text.textWidth","number",r.text.width);if(h.defined(r.text.height))if(h.number(r.text.height))i.textHeight=r.text.height;else throw h.invalidParameterError("text.height","number",r.text.height);if(h.defined(r.text.align))if(h.string(r.text.align)&&h.string(this.constructor.align[r.text.align]))i.textAlign=this.constructor.align[r.text.align];else throw h.invalidParameterError("text.align","valid alignment",r.text.align);if(h.defined(r.text.justify))if(h.bool(r.text.justify))i.textJustify=r.text.justify;else throw h.invalidParameterError("text.justify","boolean",r.text.justify);if(h.defined(r.text.dpi))if(h.number(r.text.dpi)&&h.inRange(r.text.dpi,1,1e5))i.textDpi=r.text.dpi;else throw h.invalidParameterError("text.dpi","number between 1 and 100000",r.text.dpi);if(h.defined(r.text.rgba))if(h.bool(r.text.rgba))i.textRgba=r.text.rgba;else throw h.invalidParameterError("text.rgba","bool",r.text.rgba);if(h.defined(r.text.spacing))if(h.number(r.text.spacing))i.textSpacing=r.text.spacing;else throw h.invalidParameterError("text.spacing","number",r.text.spacing);if(h.defined(r.text.wrap))if(h.string(r.text.wrap)&&h.inArray(r.text.wrap,["word","char","wordChar","none"]))i.textWrap=r.text.wrap;else throw h.invalidParameterError("text.wrap","one of: word, char, wordChar, none",r.text.wrap);delete i.buffer}else throw new Error("Expected a valid string to create an image with text.")}else if(h.defined(r))throw new Error("Invalid input options "+r);return i}function un(e,r,t){Array.isArray(this.options.input.buffer)?h.buffer(e)?(this.options.input.buffer.length===0&&this.on("finish",()=>{this.streamInFinished=!0}),this.options.input.buffer.push(e),t()):t(new Error("Non-Buffer data on Writable Stream")):t(new Error("Unexpected data on Writable Stream"))}function mn(){this._isStreamInput()&&(this.options.input.buffer=Buffer.concat(this.options.input.buffer))}function gn(){return Array.isArray(this.options.input.buffer)}function bn(e){return h.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),C.metadata(this.options,e)}):C.metadata(this.options,e),this):this._isStreamInput()?new Promise((r,t)=>{const i=()=>{this._flattenBufferIn(),C.metadata(this.options,(a,s)=>{a?t(a):r(s)})};this.writableFinished?i():this.once("finish",i)}):new Promise((r,t)=>{C.metadata(this.options,(i,a)=>{i?t(i):r(a)})})}function pn(e){return h.fn(e)?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),C.stats(this.options,e)}):C.stats(this.options,e),this):this._isStreamInput()?new Promise((r,t)=>{this.on("finish",function(){this._flattenBufferIn(),C.stats(this.options,(i,a)=>{i?t(i):r(a)})})}):new Promise((r,t)=>{C.stats(this.options,(i,a)=>{i?t(i):r(a)})})}var wn=function(e){Object.assign(e.prototype,{_inputOptionsFromObject:_r,_createInputDescriptor:dn,_write:un,_flattenBufferIn:mn,_isStreamInput:gn,metadata:bn,stats:pn}),e.align=fn};const m=M,Tr={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8},Cr={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8},Ue={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"},Or={entropy:16,attention:17},Ie={nearest:"nearest",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3"},yn={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"},vn={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function _e(e){return e.angle%360!==0||e.useExifOrientation===!0||e.rotationAngle!==0}function fe(e){return e.width!==-1||e.height!==-1}function En(e,r,t){if(fe(this.options)&&this.options.debuglog("ignoring previous resize options"),m.defined(e))if(m.object(e)&&!m.defined(t))t=e;else if(m.integer(e)&&e>0)this.options.width=e;else throw m.invalidParameterError("width","positive integer",e);else this.options.width=-1;if(m.defined(r))if(m.integer(r)&&r>0)this.options.height=r;else throw m.invalidParameterError("height","positive integer",r);else this.options.height=-1;if(m.object(t)){if(m.defined(t.width))if(m.integer(t.width)&&t.width>0)this.options.width=t.width;else throw m.invalidParameterError("width","positive integer",t.width);if(m.defined(t.height))if(m.integer(t.height)&&t.height>0)this.options.height=t.height;else throw m.invalidParameterError("height","positive integer",t.height);if(m.defined(t.fit)){const i=vn[t.fit];if(m.string(i))this.options.canvas=i;else throw m.invalidParameterError("fit","valid fit",t.fit)}if(m.defined(t.position)){const i=m.integer(t.position)?t.position:Or[t.position]||Cr[t.position]||Tr[t.position];if(m.integer(i)&&(m.inRange(i,0,8)||m.inRange(i,16,17)))this.options.position=i;else throw m.invalidParameterError("position","valid position/gravity/strategy",t.position)}if(this._setBackgroundColourOption("resizeBackground",t.background),m.defined(t.kernel))if(m.string(Ie[t.kernel]))this.options.kernel=Ie[t.kernel];else throw m.invalidParameterError("kernel","valid kernel name",t.kernel);m.defined(t.withoutEnlargement)&&this._setBooleanOption("withoutEnlargement",t.withoutEnlargement),m.defined(t.withoutReduction)&&this._setBooleanOption("withoutReduction",t.withoutReduction),m.defined(t.fastShrinkOnLoad)&&this._setBooleanOption("fastShrinkOnLoad",t.fastShrinkOnLoad)}return _e(this.options)&&fe(this.options)&&(this.options.rotateBeforePreExtract=!0),this}function xn(e){if(m.integer(e)&&e>0)this.options.extendTop=e,this.options.extendBottom=e,this.options.extendLeft=e,this.options.extendRight=e;else if(m.object(e)){if(m.defined(e.top))if(m.integer(e.top)&&e.top>=0)this.options.extendTop=e.top;else throw m.invalidParameterError("top","positive integer",e.top);if(m.defined(e.bottom))if(m.integer(e.bottom)&&e.bottom>=0)this.options.extendBottom=e.bottom;else throw m.invalidParameterError("bottom","positive integer",e.bottom);if(m.defined(e.left))if(m.integer(e.left)&&e.left>=0)this.options.extendLeft=e.left;else throw m.invalidParameterError("left","positive integer",e.left);if(m.defined(e.right))if(m.integer(e.right)&&e.right>=0)this.options.extendRight=e.right;else throw m.invalidParameterError("right","positive integer",e.right);if(this._setBackgroundColourOption("extendBackground",e.background),m.defined(e.extendWith))if(m.string(Ue[e.extendWith]))this.options.extendWith=Ue[e.extendWith];else throw m.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",e.extendWith)}else throw m.invalidParameterError("extend","integer or object",e);return this}function Pn(e){const r=fe(this.options)||this.options.widthPre!==-1?"Post":"Pre";return this.options[`width${r}`]!==-1&&this.options.debuglog("ignoring previous extract options"),["left","top","width","height"].forEach(function(t){const i=e[t];if(m.integer(i)&&i>=0)this.options[t+(t==="left"||t==="top"?"Offset":"")+r]=i;else throw m.invalidParameterError(t,"integer",i)},this),_e(this.options)&&!fe(this.options)&&(this.options.widthPre===-1||this.options.widthPost===-1)&&(this.options.rotateBeforePreExtract=!0),this}function In(e){if(!m.defined(e))this.options.trimThreshold=10;else if(m.string(e))this._setBackgroundColourOption("trimBackground",e),this.options.trimThreshold=10;else if(m.number(e))if(e>=0)this.options.trimThreshold=e;else throw m.invalidParameterError("threshold","positive number",e);else if(m.object(e))if(this._setBackgroundColourOption("trimBackground",e.background),!m.defined(e.threshold))this.options.trimThreshold=10;else if(m.number(e.threshold)&&e.threshold>=0)this.options.trimThreshold=e.threshold;else throw m.invalidParameterError("threshold","positive number",e);else throw m.invalidParameterError("trim","string, number or object",e);return _e(this.options)&&(this.options.rotateBeforePreExtract=!0),this}var kn=function(e){Object.assign(e.prototype,{resize:En,extend:xn,extract:Pn,trim:In}),e.gravity=Tr,e.strategy=Or,e.kernel=Ie,e.fit=yn,e.position=Cr};const b=M,ke={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function Rn(e){if(!Array.isArray(e))throw b.invalidParameterError("images to composite","array",e);return this.options.composite=e.map(r=>{if(!b.object(r))throw b.invalidParameterError("image to composite","object",r);const t=this._inputOptionsFromObject(r),i={input:this._createInputDescriptor(r.input,t,{allowStream:!1}),blend:"over",tile:!1,left:0,top:0,hasOffset:!1,gravity:0,premultiplied:!1};if(b.defined(r.blend))if(b.string(ke[r.blend]))i.blend=ke[r.blend];else throw b.invalidParameterError("blend","valid blend name",r.blend);if(b.defined(r.tile))if(b.bool(r.tile))i.tile=r.tile;else throw b.invalidParameterError("tile","boolean",r.tile);if(b.defined(r.left))if(b.integer(r.left))i.left=r.left;else throw b.invalidParameterError("left","integer",r.left);if(b.defined(r.top))if(b.integer(r.top))i.top=r.top;else throw b.invalidParameterError("top","integer",r.top);if(b.defined(r.top)!==b.defined(r.left))throw new Error("Expected both left and top to be set");if(i.hasOffset=b.integer(r.top)&&b.integer(r.left),b.defined(r.gravity))if(b.integer(r.gravity)&&b.inRange(r.gravity,0,8))i.gravity=r.gravity;else if(b.string(r.gravity)&&b.integer(this.constructor.gravity[r.gravity]))i.gravity=this.constructor.gravity[r.gravity];else throw b.invalidParameterError("gravity","valid gravity",r.gravity);if(b.defined(r.premultiplied))if(b.bool(r.premultiplied))i.premultiplied=r.premultiplied;else throw b.invalidParameterError("premultiplied","boolean",r.premultiplied);return i}),this}var An=function(e){e.prototype.composite=Rn,e.blend=ke};const jn=Me,o=M;function Sn(e,r){if((this.options.useExifOrientation||this.options.angle||this.options.rotationAngle)&&this.options.debuglog("ignoring previous rotate options"),!o.defined(e))this.options.useExifOrientation=!0;else if(o.integer(e)&&!(e%90))this.options.angle=e;else if(o.number(e)){if(this.options.rotationAngle=e,o.object(r)&&r.background){const t=jn(r.background);this.options.rotationBackground=[t.red(),t.green(),t.blue(),Math.round(t.alpha()*255)]}}else throw o.invalidParameterError("angle","numeric",e);return this}function Ln(e){return this.options.flip=o.bool(e)?e:!0,this}function $n(e){return this.options.flop=o.bool(e)?e:!0,this}function Fn(e,r){const t=[].concat(...e);if(t.length===4&&t.every(o.number))this.options.affineMatrix=t;else throw o.invalidParameterError("matrix","1x4 or 2x2 array",e);if(o.defined(r))if(o.object(r)){if(this._setBackgroundColourOption("affineBackground",r.background),o.defined(r.idx))if(o.number(r.idx))this.options.affineIdx=r.idx;else throw o.invalidParameterError("options.idx","number",r.idx);if(o.defined(r.idy))if(o.number(r.idy))this.options.affineIdy=r.idy;else throw o.invalidParameterError("options.idy","number",r.idy);if(o.defined(r.odx))if(o.number(r.odx))this.options.affineOdx=r.odx;else throw o.invalidParameterError("options.odx","number",r.odx);if(o.defined(r.ody))if(o.number(r.ody))this.options.affineOdy=r.ody;else throw o.invalidParameterError("options.ody","number",r.ody);if(o.defined(r.interpolator))if(o.inArray(r.interpolator,Object.values(this.constructor.interpolators)))this.options.affineInterpolator=r.interpolator;else throw o.invalidParameterError("options.interpolator","valid interpolator name",r.interpolator)}else throw o.invalidParameterError("options","object",r);return this}function Nn(e,r,t){if(!o.defined(e))this.options.sharpenSigma=-1;else if(o.bool(e))this.options.sharpenSigma=e?-1:0;else if(o.number(e)&&o.inRange(e,.01,1e4)){if(this.options.sharpenSigma=e,o.defined(r))if(o.number(r)&&o.inRange(r,0,1e4))this.options.sharpenM1=r;else throw o.invalidParameterError("flat","number between 0 and 10000",r);if(o.defined(t))if(o.number(t)&&o.inRange(t,0,1e4))this.options.sharpenM2=t;else throw o.invalidParameterError("jagged","number between 0 and 10000",t)}else if(o.plainObject(e)){if(o.number(e.sigma)&&o.inRange(e.sigma,1e-6,10))this.options.sharpenSigma=e.sigma;else throw o.invalidParameterError("options.sigma","number between 0.000001 and 10",e.sigma);if(o.defined(e.m1))if(o.number(e.m1)&&o.inRange(e.m1,0,1e6))this.options.sharpenM1=e.m1;else throw o.invalidParameterError("options.m1","number between 0 and 1000000",e.m1);if(o.defined(e.m2))if(o.number(e.m2)&&o.inRange(e.m2,0,1e6))this.options.sharpenM2=e.m2;else throw o.invalidParameterError("options.m2","number between 0 and 1000000",e.m2);if(o.defined(e.x1))if(o.number(e.x1)&&o.inRange(e.x1,0,1e6))this.options.sharpenX1=e.x1;else throw o.invalidParameterError("options.x1","number between 0 and 1000000",e.x1);if(o.defined(e.y2))if(o.number(e.y2)&&o.inRange(e.y2,0,1e6))this.options.sharpenY2=e.y2;else throw o.invalidParameterError("options.y2","number between 0 and 1000000",e.y2);if(o.defined(e.y3))if(o.number(e.y3)&&o.inRange(e.y3,0,1e6))this.options.sharpenY3=e.y3;else throw o.invalidParameterError("options.y3","number between 0 and 1000000",e.y3)}else throw o.invalidParameterError("sigma","number between 0.01 and 10000",e);return this}function Mn(e){if(!o.defined(e))this.options.medianSize=3;else if(o.integer(e)&&o.inRange(e,1,1e3))this.options.medianSize=e;else throw o.invalidParameterError("size","integer between 1 and 1000",e);return this}function _n(e){if(!o.defined(e))this.options.blurSigma=-1;else if(o.bool(e))this.options.blurSigma=e?-1:0;else if(o.number(e)&&o.inRange(e,.3,1e3))this.options.blurSigma=e;else throw o.invalidParameterError("sigma","number between 0.3 and 1000",e);return this}function Tn(e){return this.options.flatten=o.bool(e)?e:!0,o.object(e)&&this._setBackgroundColourOption("flattenBackground",e.background),this}function Cn(){return this.options.unflatten=!0,this}function On(e,r){if(!o.defined(e))this.options.gamma=2.2;else if(o.number(e)&&o.inRange(e,1,3))this.options.gamma=e;else throw o.invalidParameterError("gamma","number between 1.0 and 3.0",e);if(!o.defined(r))this.options.gammaOut=this.options.gamma;else if(o.number(r)&&o.inRange(r,1,3))this.options.gammaOut=r;else throw o.invalidParameterError("gammaOut","number between 1.0 and 3.0",r);return this}function Bn(e){if(this.options.negate=o.bool(e)?e:!0,o.plainObject(e)&&"alpha"in e)if(o.bool(e.alpha))this.options.negateAlpha=e.alpha;else throw o.invalidParameterError("alpha","should be boolean value",e.alpha);return this}function Dn(e){if(o.plainObject(e)){if(o.defined(e.lower))if(o.number(e.lower)&&o.inRange(e.lower,0,99))this.options.normaliseLower=e.lower;else throw o.invalidParameterError("lower","number between 0 and 99",e.lower);if(o.defined(e.upper))if(o.number(e.upper)&&o.inRange(e.upper,1,100))this.options.normaliseUpper=e.upper;else throw o.invalidParameterError("upper","number between 1 and 100",e.upper)}if(this.options.normaliseLower>=this.options.normaliseUpper)throw o.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`);return this.options.normalise=!0,this}function zn(e){return this.normalise(e)}function qn(e){if(o.plainObject(e)){if(o.integer(e.width)&&e.width>0)this.options.claheWidth=e.width;else throw o.invalidParameterError("width","integer greater than zero",e.width);if(o.integer(e.height)&&e.height>0)this.options.claheHeight=e.height;else throw o.invalidParameterError("height","integer greater than zero",e.height);if(o.defined(e.maxSlope))if(o.integer(e.maxSlope)&&o.inRange(e.maxSlope,0,100))this.options.claheMaxSlope=e.maxSlope;else throw o.invalidParameterError("maxSlope","integer between 0 and 100",e.maxSlope)}else throw o.invalidParameterError("options","plain object",e);return this}function Gn(e){if(!o.object(e)||!Array.isArray(e.kernel)||!o.integer(e.width)||!o.integer(e.height)||!o.inRange(e.width,3,1001)||!o.inRange(e.height,3,1001)||e.height*e.width!==e.kernel.length)throw new Error("Invalid convolution kernel");return o.integer(e.scale)||(e.scale=e.kernel.reduce(function(r,t){return r+t},0)),e.scale<1&&(e.scale=1),o.integer(e.offset)||(e.offset=0),this.options.convKernel=e,this}function Un(e,r){if(!o.defined(e))this.options.threshold=128;else if(o.bool(e))this.options.threshold=e?128:0;else if(o.integer(e)&&o.inRange(e,0,255))this.options.threshold=e;else throw o.invalidParameterError("threshold","integer between 0 and 255",e);return!o.object(r)||r.greyscale===!0||r.grayscale===!0?this.options.thresholdGrayscale=!0:this.options.thresholdGrayscale=!1,this}function Hn(e,r,t){if(this.options.boolean=this._createInputDescriptor(e,t),o.string(r)&&o.inArray(r,["and","or","eor"]))this.options.booleanOp=r;else throw o.invalidParameterError("operator","one of: and, or, eor",r);return this}function Xn(e,r){if(!o.defined(e)&&o.number(r)?e=1:o.number(e)&&!o.defined(r)&&(r=0),!o.defined(e))this.options.linearA=[];else if(o.number(e))this.options.linearA=[e];else if(Array.isArray(e)&&e.length&&e.every(o.number))this.options.linearA=e;else throw o.invalidParameterError("a","number or array of numbers",e);if(!o.defined(r))this.options.linearB=[];else if(o.number(r))this.options.linearB=[r];else if(Array.isArray(r)&&r.length&&r.every(o.number))this.options.linearB=r;else throw o.invalidParameterError("b","number or array of numbers",r);if(this.options.linearA.length!==this.options.linearB.length)throw new Error("Expected a and b to be arrays of the same length");return this}function Wn(e){if(!Array.isArray(e)||e.length!==3||e[0].length!==3||e[1].length!==3||e[2].length!==3)throw new Error("Invalid recombination matrix");return this.options.recombMatrix=[e[0][0],e[0][1],e[0][2],e[1][0],e[1][1],e[1][2],e[2][0],e[2][1],e[2][2]].map(Number),this}function Vn(e){if(!o.plainObject(e))throw o.invalidParameterError("options","plain object",e);if("brightness"in e)if(o.number(e.brightness)&&e.brightness>=0)this.options.brightness=e.brightness;else throw o.invalidParameterError("brightness","number above zero",e.brightness);if("saturation"in e)if(o.number(e.saturation)&&e.saturation>=0)this.options.saturation=e.saturation;else throw o.invalidParameterError("saturation","number above zero",e.saturation);if("hue"in e)if(o.integer(e.hue))this.options.hue=e.hue%360;else throw o.invalidParameterError("hue","number",e.hue);if("lightness"in e)if(o.number(e.lightness))this.options.lightness=e.lightness;else throw o.invalidParameterError("lightness","number",e.lightness);return this}var Qn=function(e){Object.assign(e.prototype,{rotate:Sn,flip:Ln,flop:$n,affine:Fn,sharpen:Nn,median:Mn,blur:_n,flatten:Tn,unflatten:Cn,gamma:On,negate:Bn,normalise:Dn,normalize:zn,clahe:qn,convolve:Gn,threshold:Un,boolean:Hn,linear:Xn,recomb:Wn,modulate:Vn})};const Br=Me,F=M,He={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function Kn(e){const r=Br(e);return this.options.tintA=r.a(),this.options.tintB=r.b(),this}function Jn(e){return this.options.greyscale=F.bool(e)?e:!0,this}function Yn(e){return this.greyscale(e)}function Zn(e){if(!F.string(e))throw F.invalidParameterError("colourspace","string",e);return this.options.colourspaceInput=e,this}function ea(e){return this.pipelineColourspace(e)}function ra(e){if(!F.string(e))throw F.invalidParameterError("colourspace","string",e);return this.options.colourspace=e,this}function ta(e){return this.toColourspace(e)}function ia(e,r){if(F.defined(r))if(F.object(r)||F.string(r)){const t=Br(r);this.options[e]=[t.red(),t.green(),t.blue(),Math.round(t.alpha()*255)]}else throw F.invalidParameterError("background","object or string",r)}var na=function(e){Object.assign(e.prototype,{tint:Kn,greyscale:Jn,grayscale:Yn,pipelineColourspace:Zn,pipelineColorspace:ea,toColourspace:ra,toColorspace:ta,_setBackgroundColourOption:ia}),e.colourspace=He,e.colorspace=He};const L=M,aa={and:"and",or:"or",eor:"eor"};function sa(){return this.options.removeAlpha=!0,this}function oa(e){if(L.defined(e))if(L.number(e)&&L.inRange(e,0,1))this.options.ensureAlpha=e;else throw L.invalidParameterError("alpha","number between 0 and 1",e);else this.options.ensureAlpha=1;return this}function la(e){const r={red:0,green:1,blue:2,alpha:3};if(Object.keys(r).includes(e)&&(e=r[e]),L.integer(e)&&L.inRange(e,0,4))this.options.extractChannel=e;else throw L.invalidParameterError("channel","integer or one of: red, green, blue, alpha",e);return this}function ca(e,r){return Array.isArray(e)?e.forEach(function(t){this.options.joinChannelIn.push(this._createInputDescriptor(t,r))},this):this.options.joinChannelIn.push(this._createInputDescriptor(e,r)),this}function ha(e){if(L.string(e)&&L.inArray(e,["and","or","eor"]))this.options.bandBoolOp=e;else throw L.invalidParameterError("boolOp","one of: and, or, eor",e);return this}var fa=function(e){Object.assign(e.prototype,{removeAlpha:sa,ensureAlpha:oa,extractChannel:la,joinChannel:ca,bandbool:ha}),e.bool=aa};const we=R,n=M,H=Fe,Xe=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]),da=/\.(jp[2x]|j2[kc])$/i,Dr=()=>new Error("JP2 output requires libvips with support for OpenJPEG"),zr=e=>1<<31-Math.clz32(Math.ceil(Math.log2(e)));function ua(e,r){let t;if(n.string(e)?n.string(this.options.input.file)&&we.resolve(this.options.input.file)===we.resolve(e)?t=new Error("Cannot use same file for input and output"):da.test(we.extname(e))&&!this.constructor.format.jp2k.output.file&&(t=Dr()):t=new Error("Missing output file path"),t)if(n.fn(r))r(t);else return Promise.reject(t);else return this.options.fileOut=e,this._pipeline(r);return this}function ma(e,r){return n.object(e)?this._setBooleanOption("resolveWithObject",e.resolveWithObject):this.options.resolveWithObject&&(this.options.resolveWithObject=!1),this.options.fileOut="",this._pipeline(n.fn(e)?e:r)}function ga(e){if(this.options.withMetadata=n.bool(e)?e:!0,n.object(e)){if(n.defined(e.orientation))if(n.integer(e.orientation)&&n.inRange(e.orientation,1,8))this.options.withMetadataOrientation=e.orientation;else throw n.invalidParameterError("orientation","integer between 1 and 8",e.orientation);if(n.defined(e.density))if(n.number(e.density)&&e.density>0)this.options.withMetadataDensity=e.density;else throw n.invalidParameterError("density","positive number",e.density);if(n.defined(e.icc))if(n.string(e.icc))this.options.withMetadataIcc=e.icc;else throw n.invalidParameterError("icc","string filesystem path to ICC profile",e.icc);if(n.defined(e.exif))if(n.object(e.exif))for(const[r,t]of Object.entries(e.exif))if(n.object(t))for(const[i,a]of Object.entries(t))if(n.string(a))this.options.withMetadataStrs[`exif-${r.toLowerCase()}-${i}`]=a;else throw n.invalidParameterError(`exif.${r}.${i}`,"string",a);else throw n.invalidParameterError(`exif.${r}`,"object",t);else throw n.invalidParameterError("exif","object",e.exif)}return this}function ba(e,r){const t=Xe.get((n.object(e)&&n.string(e.id)?e.id:e).toLowerCase());if(!t)throw n.invalidParameterError("format",`one of: ${[...Xe.keys()].join(", ")}`,e);return this[t](r)}function pa(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.jpegQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.progressive)&&this._setBooleanOption("jpegProgressive",e.progressive),n.defined(e.chromaSubsampling))if(n.string(e.chromaSubsampling)&&n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jpegChromaSubsampling=e.chromaSubsampling;else throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling);const r=n.bool(e.optimizeCoding)?e.optimizeCoding:e.optimiseCoding;if(n.defined(r)&&this._setBooleanOption("jpegOptimiseCoding",r),n.defined(e.mozjpeg))if(n.bool(e.mozjpeg))e.mozjpeg&&(this.options.jpegTrellisQuantisation=!0,this.options.jpegOvershootDeringing=!0,this.options.jpegOptimiseScans=!0,this.options.jpegProgressive=!0,this.options.jpegQuantisationTable=3);else throw n.invalidParameterError("mozjpeg","boolean",e.mozjpeg);const t=n.bool(e.trellisQuantization)?e.trellisQuantization:e.trellisQuantisation;n.defined(t)&&this._setBooleanOption("jpegTrellisQuantisation",t),n.defined(e.overshootDeringing)&&this._setBooleanOption("jpegOvershootDeringing",e.overshootDeringing);const i=n.bool(e.optimizeScans)?e.optimizeScans:e.optimiseScans;n.defined(i)&&(this._setBooleanOption("jpegOptimiseScans",i),i&&(this.options.jpegProgressive=!0));const a=n.number(e.quantizationTable)?e.quantizationTable:e.quantisationTable;if(n.defined(a))if(n.integer(a)&&n.inRange(a,0,8))this.options.jpegQuantisationTable=a;else throw n.invalidParameterError("quantisationTable","integer between 0 and 8",a)}return this._updateFormatOut("jpeg",e)}function wa(e){if(n.object(e)){if(n.defined(e.progressive)&&this._setBooleanOption("pngProgressive",e.progressive),n.defined(e.compressionLevel))if(n.integer(e.compressionLevel)&&n.inRange(e.compressionLevel,0,9))this.options.pngCompressionLevel=e.compressionLevel;else throw n.invalidParameterError("compressionLevel","integer between 0 and 9",e.compressionLevel);n.defined(e.adaptiveFiltering)&&this._setBooleanOption("pngAdaptiveFiltering",e.adaptiveFiltering);const r=e.colours||e.colors;if(n.defined(r))if(n.integer(r)&&n.inRange(r,2,256))this.options.pngBitdepth=zr(r);else throw n.invalidParameterError("colours","integer between 2 and 256",r);if(n.defined(e.palette)?this._setBooleanOption("pngPalette",e.palette):[e.quality,e.effort,e.colours,e.colors,e.dither].some(n.defined)&&this._setBooleanOption("pngPalette",!0),this.options.pngPalette){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,0,100))this.options.pngQuality=e.quality;else throw n.invalidParameterError("quality","integer between 0 and 100",e.quality);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,1,10))this.options.pngEffort=e.effort;else throw n.invalidParameterError("effort","integer between 1 and 10",e.effort);if(n.defined(e.dither))if(n.number(e.dither)&&n.inRange(e.dither,0,1))this.options.pngDither=e.dither;else throw n.invalidParameterError("dither","number between 0.0 and 1.0",e.dither)}}return this._updateFormatOut("png",e)}function ya(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.webpQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.alphaQuality))if(n.integer(e.alphaQuality)&&n.inRange(e.alphaQuality,0,100))this.options.webpAlphaQuality=e.alphaQuality;else throw n.invalidParameterError("alphaQuality","integer between 0 and 100",e.alphaQuality);if(n.defined(e.lossless)&&this._setBooleanOption("webpLossless",e.lossless),n.defined(e.nearLossless)&&this._setBooleanOption("webpNearLossless",e.nearLossless),n.defined(e.smartSubsample)&&this._setBooleanOption("webpSmartSubsample",e.smartSubsample),n.defined(e.preset))if(n.string(e.preset)&&n.inArray(e.preset,["default","photo","picture","drawing","icon","text"]))this.options.webpPreset=e.preset;else throw n.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",e.preset);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,0,6))this.options.webpEffort=e.effort;else throw n.invalidParameterError("effort","integer between 0 and 6",e.effort);n.defined(e.minSize)&&this._setBooleanOption("webpMinSize",e.minSize),n.defined(e.mixed)&&this._setBooleanOption("webpMixed",e.mixed)}return qr(e,this.options),this._updateFormatOut("webp",e)}function va(e){if(n.object(e)){n.defined(e.reuse)&&this._setBooleanOption("gifReuse",e.reuse),n.defined(e.progressive)&&this._setBooleanOption("gifProgressive",e.progressive);const r=e.colours||e.colors;if(n.defined(r))if(n.integer(r)&&n.inRange(r,2,256))this.options.gifBitdepth=zr(r);else throw n.invalidParameterError("colours","integer between 2 and 256",r);if(n.defined(e.effort))if(n.number(e.effort)&&n.inRange(e.effort,1,10))this.options.gifEffort=e.effort;else throw n.invalidParameterError("effort","integer between 1 and 10",e.effort);if(n.defined(e.dither))if(n.number(e.dither)&&n.inRange(e.dither,0,1))this.options.gifDither=e.dither;else throw n.invalidParameterError("dither","number between 0.0 and 1.0",e.dither);if(n.defined(e.interFrameMaxError))if(n.number(e.interFrameMaxError)&&n.inRange(e.interFrameMaxError,0,32))this.options.gifInterFrameMaxError=e.interFrameMaxError;else throw n.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",e.interFrameMaxError);if(n.defined(e.interPaletteMaxError))if(n.number(e.interPaletteMaxError)&&n.inRange(e.interPaletteMaxError,0,256))this.options.gifInterPaletteMaxError=e.interPaletteMaxError;else throw n.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",e.interPaletteMaxError)}return qr(e,this.options),this._updateFormatOut("gif",e)}function Ea(e){if(!this.constructor.format.jp2k.output.buffer)throw Dr();if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.jp2Quality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.lossless))if(n.bool(e.lossless))this.options.jp2Lossless=e.lossless;else throw n.invalidParameterError("lossless","boolean",e.lossless);if(n.defined(e.tileWidth))if(n.integer(e.tileWidth)&&n.inRange(e.tileWidth,1,32768))this.options.jp2TileWidth=e.tileWidth;else throw n.invalidParameterError("tileWidth","integer between 1 and 32768",e.tileWidth);if(n.defined(e.tileHeight))if(n.integer(e.tileHeight)&&n.inRange(e.tileHeight,1,32768))this.options.jp2TileHeight=e.tileHeight;else throw n.invalidParameterError("tileHeight","integer between 1 and 32768",e.tileHeight);if(n.defined(e.chromaSubsampling))if(n.string(e.chromaSubsampling)&&n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jp2ChromaSubsampling=e.chromaSubsampling;else throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling)}return this._updateFormatOut("jp2",e)}function qr(e,r){if(n.object(e)&&n.defined(e.loop))if(n.integer(e.loop)&&n.inRange(e.loop,0,65535))r.loop=e.loop;else throw n.invalidParameterError("loop","integer between 0 and 65535",e.loop);if(n.object(e)&&n.defined(e.delay))if(n.integer(e.delay)&&n.inRange(e.delay,0,65535))r.delay=[e.delay];else if(Array.isArray(e.delay)&&e.delay.every(n.integer)&&e.delay.every(t=>n.inRange(t,0,65535)))r.delay=e.delay;else throw n.invalidParameterError("delay","integer or an array of integers between 0 and 65535",e.delay)}function xa(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.tiffQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.bitdepth))if(n.integer(e.bitdepth)&&n.inArray(e.bitdepth,[1,2,4,8]))this.options.tiffBitdepth=e.bitdepth;else throw n.invalidParameterError("bitdepth","1, 2, 4 or 8",e.bitdepth);if(n.defined(e.tile)&&this._setBooleanOption("tiffTile",e.tile),n.defined(e.tileWidth))if(n.integer(e.tileWidth)&&e.tileWidth>0)this.options.tiffTileWidth=e.tileWidth;else throw n.invalidParameterError("tileWidth","integer greater than zero",e.tileWidth);if(n.defined(e.tileHeight))if(n.integer(e.tileHeight)&&e.tileHeight>0)this.options.tiffTileHeight=e.tileHeight;else throw n.invalidParameterError("tileHeight","integer greater than zero",e.tileHeight);if(n.defined(e.pyramid)&&this._setBooleanOption("tiffPyramid",e.pyramid),n.defined(e.xres))if(n.number(e.xres)&&e.xres>0)this.options.tiffXres=e.xres;else throw n.invalidParameterError("xres","number greater than zero",e.xres);if(n.defined(e.yres))if(n.number(e.yres)&&e.yres>0)this.options.tiffYres=e.yres;else throw n.invalidParameterError("yres","number greater than zero",e.yres);if(n.defined(e.compression))if(n.string(e.compression)&&n.inArray(e.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"]))this.options.tiffCompression=e.compression;else throw n.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",e.compression);if(n.defined(e.predictor))if(n.string(e.predictor)&&n.inArray(e.predictor,["none","horizontal","float"]))this.options.tiffPredictor=e.predictor;else throw n.invalidParameterError("predictor","one of: none, horizontal, float",e.predictor);if(n.defined(e.resolutionUnit))if(n.string(e.resolutionUnit)&&n.inArray(e.resolutionUnit,["inch","cm"]))this.options.tiffResolutionUnit=e.resolutionUnit;else throw n.invalidParameterError("resolutionUnit","one of: inch, cm",e.resolutionUnit)}return this._updateFormatOut("tiff",e)}function Pa(e){return this.heif({...e,compression:"av1"})}function Ia(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.heifQuality=e.quality;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);if(n.defined(e.lossless))if(n.bool(e.lossless))this.options.heifLossless=e.lossless;else throw n.invalidParameterError("lossless","boolean",e.lossless);if(n.defined(e.compression))if(n.string(e.compression)&&n.inArray(e.compression,["av1","hevc"]))this.options.heifCompression=e.compression;else throw n.invalidParameterError("compression","one of: av1, hevc",e.compression);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,0,9))this.options.heifEffort=e.effort;else throw n.invalidParameterError("effort","integer between 0 and 9",e.effort);if(n.defined(e.chromaSubsampling))if(n.string(e.chromaSubsampling)&&n.inArray(e.chromaSubsampling,["4:2:0","4:4:4"]))this.options.heifChromaSubsampling=e.chromaSubsampling;else throw n.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",e.chromaSubsampling)}return this._updateFormatOut("heif",e)}function ka(e){if(n.object(e)){if(n.defined(e.quality))if(n.integer(e.quality)&&n.inRange(e.quality,1,100))this.options.jxlDistance=e.quality>=30?.1+(100-e.quality)*.09:53/3e3*e.quality*e.quality-23/20*e.quality+25;else throw n.invalidParameterError("quality","integer between 1 and 100",e.quality);else if(n.defined(e.distance))if(n.number(e.distance)&&n.inRange(e.distance,0,15))this.options.jxlDistance=e.distance;else throw n.invalidParameterError("distance","number between 0.0 and 15.0",e.distance);if(n.defined(e.decodingTier))if(n.integer(e.decodingTier)&&n.inRange(e.decodingTier,0,4))this.options.jxlDecodingTier=e.decodingTier;else throw n.invalidParameterError("decodingTier","integer between 0 and 4",e.decodingTier);if(n.defined(e.lossless))if(n.bool(e.lossless))this.options.jxlLossless=e.lossless;else throw n.invalidParameterError("lossless","boolean",e.lossless);if(n.defined(e.effort))if(n.integer(e.effort)&&n.inRange(e.effort,3,9))this.options.jxlEffort=e.effort;else throw n.invalidParameterError("effort","integer between 3 and 9",e.effort)}return this._updateFormatOut("jxl",e)}function Ra(e){if(n.object(e)&&n.defined(e.depth))if(n.string(e.depth)&&n.inArray(e.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"]))this.options.rawDepth=e.depth;else throw n.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",e.depth);return this._updateFormatOut("raw")}function Aa(e){if(n.object(e)){if(n.defined(e.size))if(n.integer(e.size)&&n.inRange(e.size,1,8192))this.options.tileSize=e.size;else throw n.invalidParameterError("size","integer between 1 and 8192",e.size);if(n.defined(e.overlap))if(n.integer(e.overlap)&&n.inRange(e.overlap,0,8192)){if(e.overlap>this.options.tileSize)throw n.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,e.overlap);this.options.tileOverlap=e.overlap}else throw n.invalidParameterError("overlap","integer between 0 and 8192",e.overlap);if(n.defined(e.container))if(n.string(e.container)&&n.inArray(e.container,["fs","zip"]))this.options.tileContainer=e.container;else throw n.invalidParameterError("container","one of: fs, zip",e.container);if(n.defined(e.layout))if(n.string(e.layout)&&n.inArray(e.layout,["dz","google","iiif","iiif3","zoomify"]))this.options.tileLayout=e.layout;else throw n.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",e.layout);if(n.defined(e.angle))if(n.integer(e.angle)&&!(e.angle%90))this.options.tileAngle=e.angle;else throw n.invalidParameterError("angle","positive/negative multiple of 90",e.angle);if(this._setBackgroundColourOption("tileBackground",e.background),n.defined(e.depth))if(n.string(e.depth)&&n.inArray(e.depth,["onepixel","onetile","one"]))this.options.tileDepth=e.depth;else throw n.invalidParameterError("depth","one of: onepixel, onetile, one",e.depth);if(n.defined(e.skipBlanks))if(n.integer(e.skipBlanks)&&n.inRange(e.skipBlanks,-1,65535))this.options.tileSkipBlanks=e.skipBlanks;else throw n.invalidParameterError("skipBlanks","integer between -1 and 255/65535",e.skipBlanks);else n.defined(e.layout)&&e.layout==="google"&&(this.options.tileSkipBlanks=5);const r=n.bool(e.center)?e.center:e.centre;if(n.defined(r)&&this._setBooleanOption("tileCentre",r),n.defined(e.id))if(n.string(e.id))this.options.tileId=e.id;else throw n.invalidParameterError("id","string",e.id);if(n.defined(e.basename))if(n.string(e.basename))this.options.tileBasename=e.basename;else throw n.invalidParameterError("basename","string",e.basename)}if(n.inArray(this.options.formatOut,["jpeg","png","webp"]))this.options.tileFormat=this.options.formatOut;else if(this.options.formatOut!=="input")throw n.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut);return this._updateFormatOut("dz")}function ja(e){if(!n.plainObject(e))throw n.invalidParameterError("options","object",e);if(n.integer(e.seconds)&&n.inRange(e.seconds,0,3600))this.options.timeoutSeconds=e.seconds;else throw n.invalidParameterError("seconds","integer between 0 and 3600",e.seconds);return this}function Sa(e,r){return n.object(r)&&r.force===!1||(this.options.formatOut=e),this}function La(e,r){if(n.bool(r))this.options[e]=r;else throw n.invalidParameterError(e,"boolean",r)}function $a(){this.options.streamOut||(this.options.streamOut=!0,this._pipeline())}function Fa(e){return typeof e=="function"?(this._isStreamInput()?this.on("finish",()=>{this._flattenBufferIn(),H.pipeline(this.options,e)}):H.pipeline(this.options,e),this):this.options.streamOut?(this._isStreamInput()?(this.once("finish",()=>{this._flattenBufferIn(),H.pipeline(this.options,(r,t,i)=>{r?this.emit("error",r):(this.emit("info",i),this.push(t)),this.push(null),this.on("end",()=>this.emit("close"))})}),this.streamInFinished&&this.emit("finish")):H.pipeline(this.options,(r,t,i)=>{r?this.emit("error",r):(this.emit("info",i),this.push(t)),this.push(null),this.on("end",()=>this.emit("close"))}),this):this._isStreamInput()?new Promise((r,t)=>{this.once("finish",()=>{this._flattenBufferIn(),H.pipeline(this.options,(i,a,s)=>{i?t(i):this.options.resolveWithObject?r({data:a,info:s}):r(a)})})}):new Promise((r,t)=>{H.pipeline(this.options,(i,a,s)=>{i?t(i):this.options.resolveWithObject?r({data:a,info:s}):r(a)})})}var Na=function(e){Object.assign(e.prototype,{toFile:ua,toBuffer:ma,withMetadata:ga,toFormat:ba,jpeg:pa,jp2:Ea,png:wa,webp:ya,tiff:xa,avif:Pa,heif:Ia,jxl:ka,gif:va,raw:Ra,tile:Aa,timeout:ja,_updateFormatOut:Sa,_setBooleanOption:La,_read:$a,_pipeline:Fa})};const Ma=R,_a=R,Ta=R,We=pr,k=M,Gr=Ae(),I=Fe,re=I.format();re.heif.output.alias=["avif","heic"];re.jpeg.output.alias=["jpe","jpg"];re.tiff.output.alias=["tif"];re.jp2k.output.alias=["j2c","j2k","jp2","jpx"];const Ca={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"};let Z={vips:I.libvipsVersion()};try{Z=Rr(`../vendor/${Z.vips}/${Gr}/versions.json`)}catch{}Z.sharp=yr.version;const Ur={current:Gr,installed:[]};try{Ur.installed=Ma.readdirSync(_a.join(__dirname,`../vendor/${Z.vips}`))}catch{}function Hr(e){return k.bool(e)?e?I.cache(50,20,100):I.cache(0,0,0):k.object(e)?I.cache(e.memory,e.files,e.items):I.cache()}Hr(!0);function Oa(e){return I.concurrency(k.integer(e)?e:null)}We.familySync()===We.GLIBC&&!I._isUsingJemalloc()&&I.concurrency(1);const Ba=new Ta.EventEmitter;function Da(){return I.counters()}function Xr(e){return I.simd(k.bool(e)?e:null)}Xr(!0);function za(e){if(k.object(e))if(Array.isArray(e.operation)&&e.operation.every(k.string))I.block(e.operation,!0);else throw k.invalidParameterError("operation","Array<string>",e.operation);else throw k.invalidParameterError("options","object",e)}function qa(e){if(k.object(e))if(Array.isArray(e.operation)&&e.operation.every(k.string))I.block(e.operation,!1);else throw k.invalidParameterError("operation","Array<string>",e.operation);else throw k.invalidParameterError("options","object",e)}var Ga=function(e){e.cache=Hr,e.concurrency=Oa,e.counters=Da,e.simd=Xr,e.format=re,e.interpolators=Ca,e.versions=Z,e.vendor=Ur,e.queue=Ba,e.block=za,e.unblock=qa};const _=Di;wn(_);kn(_);An(_);Qn(_);na(_);fa(_);Na(_);Ga(_);var Wr=_;const Ua=Jr(Wr),Xa=Yr({__proto__:null,default:Ua},[Wr]);export{Xa as i};
